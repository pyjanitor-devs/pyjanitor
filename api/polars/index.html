
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python implementation of the R package janitor">
      
      
      
        <link rel="canonical" href="https://pyjanitor-devs.github.io/pyjanitor/api/polars/">
      
      
        <link rel="prev" href="../math/">
      
      
        <link rel="next" href="../timeseries/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.41">
    
    
      
        <title>Polars - pyjanitor documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/apidocs.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#polars" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="pyjanitor documentation" class="md-header__button md-logo" aria-label="pyjanitor documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96m0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32m32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16m16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pyjanitor documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Polars
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="light-blue"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pyjanitor-devs/pyjanitor" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    pyjanitor-devs/pyjanitor
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="pyjanitor documentation" class="md-nav__button md-logo" aria-label="pyjanitor documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96m0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32m32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16m16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16"/></svg>

    </a>
    pyjanitor documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pyjanitor-devs/pyjanitor" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    pyjanitor-devs/pyjanitor
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../biology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Biology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chemistry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chemistry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../engineering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Engineering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../finance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Finance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input/Output (io)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../math/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Math
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Polars
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Polars
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#janitor.polars.clean_names" class="md-nav__link">
    <span class="md-ellipsis">
      clean_names
    </span>
  </a>
  
    <nav class="md-nav" aria-label="clean_names">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#janitor.polars.clean_names.clean_names" class="md-nav__link">
    <span class="md-ellipsis">
      clean_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#janitor.polars.clean_names.make_clean_names" class="md-nav__link">
    <span class="md-ellipsis">
      make_clean_names
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#janitor.polars.complete" class="md-nav__link">
    <span class="md-ellipsis">
      complete
    </span>
  </a>
  
    <nav class="md-nav" aria-label="complete">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#janitor.polars.complete.complete" class="md-nav__link">
    <span class="md-ellipsis">
      complete
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#janitor.polars.complete.expand" class="md-nav__link">
    <span class="md-ellipsis">
      expand
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#janitor.polars.pivot_longer" class="md-nav__link">
    <span class="md-ellipsis">
      pivot_longer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pivot_longer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#janitor.polars.pivot_longer.pivot_longer" class="md-nav__link">
    <span class="md-ellipsis">
      pivot_longer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#janitor.polars.pivot_longer.pivot_longer_spec" class="md-nav__link">
    <span class="md-ellipsis">
      pivot_longer_spec
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#janitor.polars.row_to_names" class="md-nav__link">
    <span class="md-ellipsis">
      row_to_names
    </span>
  </a>
  
    <nav class="md-nav" aria-label="row_to_names">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#janitor.polars.row_to_names.row_to_names" class="md-nav__link">
    <span class="md-ellipsis">
      row_to_names
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../timeseries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timeseries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xarray/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XArray
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devguide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development Guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CHANGELOG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AUTHORS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authors
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#janitor.polars.clean_names" class="md-nav__link">
    <span class="md-ellipsis">
      clean_names
    </span>
  </a>
  
    <nav class="md-nav" aria-label="clean_names">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#janitor.polars.clean_names.clean_names" class="md-nav__link">
    <span class="md-ellipsis">
      clean_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#janitor.polars.clean_names.make_clean_names" class="md-nav__link">
    <span class="md-ellipsis">
      make_clean_names
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#janitor.polars.complete" class="md-nav__link">
    <span class="md-ellipsis">
      complete
    </span>
  </a>
  
    <nav class="md-nav" aria-label="complete">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#janitor.polars.complete.complete" class="md-nav__link">
    <span class="md-ellipsis">
      complete
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#janitor.polars.complete.expand" class="md-nav__link">
    <span class="md-ellipsis">
      expand
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#janitor.polars.pivot_longer" class="md-nav__link">
    <span class="md-ellipsis">
      pivot_longer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pivot_longer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#janitor.polars.pivot_longer.pivot_longer" class="md-nav__link">
    <span class="md-ellipsis">
      pivot_longer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#janitor.polars.pivot_longer.pivot_longer_spec" class="md-nav__link">
    <span class="md-ellipsis">
      pivot_longer_spec
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#janitor.polars.row_to_names" class="md-nav__link">
    <span class="md-ellipsis">
      row_to_names
    </span>
  </a>
  
    <nav class="md-nav" aria-label="row_to_names">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#janitor.polars.row_to_names.row_to_names" class="md-nav__link">
    <span class="md-ellipsis">
      row_to_names
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="polars">Polars</h1>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h2 id="janitor.polars.clean_names" class="doc doc-heading">
            <code>clean_names</code>


</h2>

    <div class="doc doc-contents ">

        <p>clean_names implementation for polars.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="janitor.polars.clean_names.clean_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clean_names</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">strip_underscores</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">case_type</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">remove_special</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">strip_accents</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">truncate_limit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Clean the column names in a polars DataFrame.</p>
<p><code>clean_names</code> can also be applied to a LazyFrame.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">janitor.polars</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;Aloha&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
<span class="gp">... </span>        <span class="s2">&quot;Bell Chart&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
<span class="gp">... </span>        <span class="s2">&quot;Animals@#$%^&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (3, 3)</span>
<span class="go">┌───────┬────────────┬──────────────┐</span>
<span class="go">│ Aloha ┆ Bell Chart ┆ Animals@#$%^ │</span>
<span class="go">│ ---   ┆ ---        ┆ ---          │</span>
<span class="go">│ i64   ┆ i64        ┆ i64          │</span>
<span class="go">╞═══════╪════════════╪══════════════╡</span>
<span class="go">│ 0     ┆ 0          ┆ 0            │</span>
<span class="go">│ 1     ┆ 1          ┆ 1            │</span>
<span class="go">│ 2     ┆ 2          ┆ 2            │</span>
<span class="go">└───────┴────────────┴──────────────┘</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">clean_names</span><span class="p">(</span><span class="n">remove_special</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">shape: (3, 3)</span>
<span class="go">┌───────┬────────────┬─────────┐</span>
<span class="go">│ aloha ┆ bell_chart ┆ animals │</span>
<span class="go">│ ---   ┆ ---        ┆ ---     │</span>
<span class="go">│ i64   ┆ i64        ┆ i64     │</span>
<span class="go">╞═══════╪════════════╪═════════╡</span>
<span class="go">│ 0     ┆ 0          ┆ 0       │</span>
<span class="go">│ 1     ┆ 1          ┆ 1       │</span>
<span class="go">│ 2     ┆ 2          ┆ 2       │</span>
<span class="go">└───────┴────────────┴─────────┘</span>
</code></pre></div>
        <div class="admonition info">
<p class="admonition-title">New in version 0.28.0</p>
</div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>strip_underscores</code>
            </td>
            <td>
                  <code>str | bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Removes the outer underscores from all
column names. Default None keeps outer underscores. Values can be
either 'left', 'right' or 'both' or the respective shorthand 'l',
'r' and True.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>case_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to make the column names lower or uppercase.
Current case may be preserved with 'preserve',
while snake case conversion (from CamelCase or camelCase only)
can be turned on using "snake".
Default 'lower' makes all characters lowercase.</p>
              </div>
            </td>
            <td>
                  <code>&#39;lower&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>remove_special</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Remove special characters from the column names.
Only letters, numbers and underscores are preserved.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strip_accents</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to remove accents from
the labels.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>truncate_limit</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Truncates formatted column names to
the specified length. Default None does not truncate.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame | LazyFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A polars DataFrame/LazyFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>janitor/polars/clean_names.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@register_lazyframe_method</span>
<span class="nd">@register_dataframe_method</span>
<span class="k">def</span> <span class="nf">clean_names</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">,</span>
    <span class="n">strip_underscores</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">case_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span>
    <span class="n">remove_special</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">strip_accents</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">truncate_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clean the column names in a polars DataFrame.</span>

<span class="sd">    `clean_names` can also be applied to a LazyFrame.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import polars as pl</span>
<span class="sd">        &gt;&gt;&gt; import janitor.polars</span>
<span class="sd">        &gt;&gt;&gt; df = pl.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...         &quot;Aloha&quot;: range(3),</span>
<span class="sd">        ...         &quot;Bell Chart&quot;: range(3),</span>
<span class="sd">        ...         &quot;Animals@#$%^&quot;: range(3)</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">        shape: (3, 3)</span>
<span class="sd">        ┌───────┬────────────┬──────────────┐</span>
<span class="sd">        │ Aloha ┆ Bell Chart ┆ Animals@#$%^ │</span>
<span class="sd">        │ ---   ┆ ---        ┆ ---          │</span>
<span class="sd">        │ i64   ┆ i64        ┆ i64          │</span>
<span class="sd">        ╞═══════╪════════════╪══════════════╡</span>
<span class="sd">        │ 0     ┆ 0          ┆ 0            │</span>
<span class="sd">        │ 1     ┆ 1          ┆ 1            │</span>
<span class="sd">        │ 2     ┆ 2          ┆ 2            │</span>
<span class="sd">        └───────┴────────────┴──────────────┘</span>
<span class="sd">        &gt;&gt;&gt; df.clean_names(remove_special=True)</span>
<span class="sd">        shape: (3, 3)</span>
<span class="sd">        ┌───────┬────────────┬─────────┐</span>
<span class="sd">        │ aloha ┆ bell_chart ┆ animals │</span>
<span class="sd">        │ ---   ┆ ---        ┆ ---     │</span>
<span class="sd">        │ i64   ┆ i64        ┆ i64     │</span>
<span class="sd">        ╞═══════╪════════════╪═════════╡</span>
<span class="sd">        │ 0     ┆ 0          ┆ 0       │</span>
<span class="sd">        │ 1     ┆ 1          ┆ 1       │</span>
<span class="sd">        │ 2     ┆ 2          ┆ 2       │</span>
<span class="sd">        └───────┴────────────┴─────────┘</span>

<span class="sd">    !!! info &quot;New in version 0.28.0&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        strip_underscores: Removes the outer underscores from all</span>
<span class="sd">            column names. Default None keeps outer underscores. Values can be</span>
<span class="sd">            either &#39;left&#39;, &#39;right&#39; or &#39;both&#39; or the respective shorthand &#39;l&#39;,</span>
<span class="sd">            &#39;r&#39; and True.</span>
<span class="sd">        case_type: Whether to make the column names lower or uppercase.</span>
<span class="sd">            Current case may be preserved with &#39;preserve&#39;,</span>
<span class="sd">            while snake case conversion (from CamelCase or camelCase only)</span>
<span class="sd">            can be turned on using &quot;snake&quot;.</span>
<span class="sd">            Default &#39;lower&#39; makes all characters lowercase.</span>
<span class="sd">        remove_special: Remove special characters from the column names.</span>
<span class="sd">            Only letters, numbers and underscores are preserved.</span>
<span class="sd">        strip_accents: Whether or not to remove accents from</span>
<span class="sd">            the labels.</span>
<span class="sd">        truncate_limit: Truncates formatted column names to</span>
<span class="sd">            the specified length. Default None does not truncate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A polars DataFrame/LazyFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">col</span><span class="p">:</span> <span class="n">_clean_column_names</span><span class="p">(</span>
            <span class="n">obj</span><span class="o">=</span><span class="n">col</span><span class="p">,</span>
            <span class="n">strip_accents</span><span class="o">=</span><span class="n">strip_accents</span><span class="p">,</span>
            <span class="n">strip_underscores</span><span class="o">=</span><span class="n">strip_underscores</span><span class="p">,</span>
            <span class="n">case_type</span><span class="o">=</span><span class="n">case_type</span><span class="p">,</span>
            <span class="n">remove_special</span><span class="o">=</span><span class="n">remove_special</span><span class="p">,</span>
            <span class="n">truncate_limit</span><span class="o">=</span><span class="n">truncate_limit</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="janitor.polars.clean_names.make_clean_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_clean_names</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">strip_underscores</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">case_type</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">remove_special</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">strip_accents</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">enforce_string</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">truncate_limit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Clean the labels in a polars Expression.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">janitor.polars</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Abçdê fgí j&quot;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (1, 1)</span>
<span class="go">┌─────────────┐</span>
<span class="go">│ raw         │</span>
<span class="go">│ ---         │</span>
<span class="go">│ str         │</span>
<span class="go">╞═════════════╡</span>
<span class="go">│ Abçdê fgí j │</span>
<span class="go">└─────────────┘</span>
</code></pre></div>
    <p>Clean the column values:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;raw&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">make_clean_names</span><span class="p">(</span><span class="n">strip_accents</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">shape: (1, 1)</span>
<span class="go">┌─────────────┐</span>
<span class="go">│ raw         │</span>
<span class="go">│ ---         │</span>
<span class="go">│ str         │</span>
<span class="go">╞═════════════╡</span>
<span class="go">│ abcde_fgi_j │</span>
<span class="go">└─────────────┘</span>
</code></pre></div>
        <div class="admonition info">
<p class="admonition-title">New in version 0.28.0</p>
</div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>strip_underscores</code>
            </td>
            <td>
                  <code>str | bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Removes the outer underscores
from all labels in the expression.
Default None keeps outer underscores.
Values can be either 'left', 'right'
or 'both' or the respective shorthand 'l',
'r' and True.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>case_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to make the labels in the expression lower or uppercase.
Current case may be preserved with 'preserve',
while snake case conversion (from CamelCase or camelCase only)
can be turned on using "snake".
Default 'lower' makes all characters lowercase.</p>
              </div>
            </td>
            <td>
                  <code>&#39;lower&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>remove_special</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Remove special characters from the values in the expression.
Only letters, numbers and underscores are preserved.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strip_accents</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to remove accents from
the expression.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>enforce_string</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to cast the expression to a string type.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>truncate_limit</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Truncates formatted labels in the expression to
the specified length. Default None does not truncate.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Expr</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A polars Expression.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>janitor/polars/clean_names.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@register_expr_method</span>
<span class="k">def</span> <span class="nf">make_clean_names</span><span class="p">(</span>
    <span class="n">expression</span><span class="p">,</span>
    <span class="n">strip_underscores</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">case_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span>
    <span class="n">remove_special</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">strip_accents</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">enforce_string</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">truncate_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clean the labels in a polars Expression.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import polars as pl</span>
<span class="sd">        &gt;&gt;&gt; import janitor.polars</span>
<span class="sd">        &gt;&gt;&gt; df = pl.DataFrame({&quot;raw&quot;: [&quot;Abçdê fgí j&quot;]})</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">        shape: (1, 1)</span>
<span class="sd">        ┌─────────────┐</span>
<span class="sd">        │ raw         │</span>
<span class="sd">        │ ---         │</span>
<span class="sd">        │ str         │</span>
<span class="sd">        ╞═════════════╡</span>
<span class="sd">        │ Abçdê fgí j │</span>
<span class="sd">        └─────────────┘</span>

<span class="sd">        Clean the column values:</span>
<span class="sd">        &gt;&gt;&gt; df.with_columns(pl.col(&quot;raw&quot;).make_clean_names(strip_accents=True))</span>
<span class="sd">        shape: (1, 1)</span>
<span class="sd">        ┌─────────────┐</span>
<span class="sd">        │ raw         │</span>
<span class="sd">        │ ---         │</span>
<span class="sd">        │ str         │</span>
<span class="sd">        ╞═════════════╡</span>
<span class="sd">        │ abcde_fgi_j │</span>
<span class="sd">        └─────────────┘</span>

<span class="sd">    !!! info &quot;New in version 0.28.0&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        strip_underscores: Removes the outer underscores</span>
<span class="sd">            from all labels in the expression.</span>
<span class="sd">            Default None keeps outer underscores.</span>
<span class="sd">            Values can be either &#39;left&#39;, &#39;right&#39;</span>
<span class="sd">            or &#39;both&#39; or the respective shorthand &#39;l&#39;,</span>
<span class="sd">            &#39;r&#39; and True.</span>
<span class="sd">        case_type: Whether to make the labels in the expression lower or uppercase.</span>
<span class="sd">            Current case may be preserved with &#39;preserve&#39;,</span>
<span class="sd">            while snake case conversion (from CamelCase or camelCase only)</span>
<span class="sd">            can be turned on using &quot;snake&quot;.</span>
<span class="sd">            Default &#39;lower&#39; makes all characters lowercase.</span>
<span class="sd">        remove_special: Remove special characters from the values in the expression.</span>
<span class="sd">            Only letters, numbers and underscores are preserved.</span>
<span class="sd">        strip_accents: Whether or not to remove accents from</span>
<span class="sd">            the expression.</span>
<span class="sd">        enforce_string: Whether or not to cast the expression to a string type.</span>
<span class="sd">        truncate_limit: Truncates formatted labels in the expression to</span>
<span class="sd">            the specified length. Default None does not truncate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A polars Expression.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_clean_expr_names</span><span class="p">(</span>
        <span class="n">obj</span><span class="o">=</span><span class="n">expression</span><span class="p">,</span>
        <span class="n">strip_accents</span><span class="o">=</span><span class="n">strip_accents</span><span class="p">,</span>
        <span class="n">strip_underscores</span><span class="o">=</span><span class="n">strip_underscores</span><span class="p">,</span>
        <span class="n">case_type</span><span class="o">=</span><span class="n">case_type</span><span class="p">,</span>
        <span class="n">remove_special</span><span class="o">=</span><span class="n">remove_special</span><span class="p">,</span>
        <span class="n">enforce_string</span><span class="o">=</span><span class="n">enforce_string</span><span class="p">,</span>
        <span class="n">truncate_limit</span><span class="o">=</span><span class="n">truncate_limit</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="janitor.polars.complete" class="doc doc-heading">
            <code>complete</code>


</h2>

    <div class="doc doc-contents ">

        <p>complete implementation for polars.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="janitor.polars.complete.complete" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">complete</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">*</span><span class="n">columns</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">explicit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Turns implicit missing values into explicit missing values</p>
<p>It is modeled after tidyr's <code>complete</code> function.
In a way, it is the inverse of <code>pl.drop_nulls</code>,
as it exposes implicitly missing rows.</p>
<p>If new values need to be introduced, a polars Expression
or a polars Series with the new values can be passed,
as long as the polars Expression/Series
has a name that already exists in the DataFrame.</p>
<p><code>complete</code> can also be applied to a LazyFrame.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">janitor.polars</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="nb">dict</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">group</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">item_id</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">item_name</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">value1</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">value2</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (4, 5)</span>
<span class="go">┌───────┬─────────┬───────────┬────────┬────────┐</span>
<span class="go">│ group ┆ item_id ┆ item_name ┆ value1 ┆ value2 │</span>
<span class="go">│ ---   ┆ ---     ┆ ---       ┆ ---    ┆ ---    │</span>
<span class="go">│ i64   ┆ i64     ┆ str       ┆ i64    ┆ i64    │</span>
<span class="go">╞═══════╪═════════╪═══════════╪════════╪════════╡</span>
<span class="go">│ 1     ┆ 1       ┆ a         ┆ 1      ┆ 4      │</span>
<span class="go">│ 2     ┆ 2       ┆ a         ┆ null   ┆ 5      │</span>
<span class="go">│ 1     ┆ 2       ┆ b         ┆ 3      ┆ 6      │</span>
<span class="go">│ 2     ┆ 3       ┆ b         ┆ 4      ┆ 7      │</span>
<span class="go">└───────┴─────────┴───────────┴────────┴────────┘</span>
</code></pre></div>
    <p>Generate all possible combinations of
<code>group</code>, <code>item_id</code>, and <code>item_name</code>
(whether or not they appear in the data)</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pl</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">tbl_rows</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">.</span><span class="n">complete</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="s2">&quot;item_id&quot;</span><span class="p">,</span> <span class="s2">&quot;item_name&quot;</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">shape: (12, 5)</span>
<span class="go">┌───────┬─────────┬───────────┬────────┬────────┐</span>
<span class="go">│ group ┆ item_id ┆ item_name ┆ value1 ┆ value2 │</span>
<span class="go">│ ---   ┆ ---     ┆ ---       ┆ ---    ┆ ---    │</span>
<span class="go">│ i64   ┆ i64     ┆ str       ┆ i64    ┆ i64    │</span>
<span class="go">╞═══════╪═════════╪═══════════╪════════╪════════╡</span>
<span class="go">│ 1     ┆ 1       ┆ a         ┆ 1      ┆ 4      │</span>
<span class="go">│ 1     ┆ 1       ┆ b         ┆ null   ┆ null   │</span>
<span class="go">│ 1     ┆ 2       ┆ a         ┆ null   ┆ null   │</span>
<span class="go">│ 1     ┆ 2       ┆ b         ┆ 3      ┆ 6      │</span>
<span class="go">│ 1     ┆ 3       ┆ a         ┆ null   ┆ null   │</span>
<span class="go">│ 1     ┆ 3       ┆ b         ┆ null   ┆ null   │</span>
<span class="go">│ 2     ┆ 1       ┆ a         ┆ null   ┆ null   │</span>
<span class="go">│ 2     ┆ 1       ┆ b         ┆ null   ┆ null   │</span>
<span class="go">│ 2     ┆ 2       ┆ a         ┆ null   ┆ 5      │</span>
<span class="go">│ 2     ┆ 2       ┆ b         ┆ null   ┆ null   │</span>
<span class="go">│ 2     ┆ 3       ┆ a         ┆ null   ┆ null   │</span>
<span class="go">│ 2     ┆ 3       ┆ b         ┆ 4      ┆ 7      │</span>
<span class="go">└───────┴─────────┴───────────┴────────┴────────┘</span>
</code></pre></div>
    <p>Cross all possible <code>group</code> values with the unique pairs of
<code>(item_id, item_name)</code> that already exist in the data.</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pl</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">tbl_rows</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">struct</span><span class="p">(</span><span class="s2">&quot;item_id&quot;</span><span class="p">,</span> <span class="s2">&quot;item_name&quot;</span><span class="p">),</span> <span class="s2">&quot;value1&quot;</span><span class="p">,</span> <span class="s2">&quot;value2&quot;</span>
<span class="gp">... </span>    <span class="p">)</span><span class="o">.</span><span class="n">complete</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="s2">&quot;item_id&quot;</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">unnest</span><span class="p">(</span><span class="s2">&quot;item_id&quot;</span><span class="p">)</span>
<span class="go">shape: (8, 5)</span>
<span class="go">┌───────┬─────────┬───────────┬────────┬────────┐</span>
<span class="go">│ group ┆ item_id ┆ item_name ┆ value1 ┆ value2 │</span>
<span class="go">│ ---   ┆ ---     ┆ ---       ┆ ---    ┆ ---    │</span>
<span class="go">│ i64   ┆ i64     ┆ str       ┆ i64    ┆ i64    │</span>
<span class="go">╞═══════╪═════════╪═══════════╪════════╪════════╡</span>
<span class="go">│ 1     ┆ 1       ┆ a         ┆ 1      ┆ 4      │</span>
<span class="go">│ 1     ┆ 2       ┆ a         ┆ null   ┆ null   │</span>
<span class="go">│ 1     ┆ 2       ┆ b         ┆ 3      ┆ 6      │</span>
<span class="go">│ 1     ┆ 3       ┆ b         ┆ null   ┆ null   │</span>
<span class="go">│ 2     ┆ 1       ┆ a         ┆ null   ┆ null   │</span>
<span class="go">│ 2     ┆ 2       ┆ a         ┆ null   ┆ 5      │</span>
<span class="go">│ 2     ┆ 2       ┆ b         ┆ null   ┆ null   │</span>
<span class="go">│ 2     ┆ 3       ┆ b         ┆ 4      ┆ 7      │</span>
<span class="go">└───────┴─────────┴───────────┴────────┴────────┘</span>
</code></pre></div>
    <p>Fill in nulls:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pl</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">tbl_rows</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">struct</span><span class="p">(</span><span class="s2">&quot;item_id&quot;</span><span class="p">,</span> <span class="s2">&quot;item_name&quot;</span><span class="p">),</span> <span class="s2">&quot;value1&quot;</span><span class="p">,</span> <span class="s2">&quot;value2&quot;</span>
<span class="gp">... </span>    <span class="p">)</span><span class="o">.</span><span class="n">complete</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s2">&quot;group&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;item_id&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">fill_value</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;value1&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;value2&quot;</span><span class="p">:</span> <span class="mi">99</span><span class="p">},</span>
<span class="gp">... </span>        <span class="n">explicit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">)</span><span class="o">.</span><span class="n">unnest</span><span class="p">(</span><span class="s2">&quot;item_id&quot;</span><span class="p">)</span>
<span class="go">shape: (8, 5)</span>
<span class="go">┌───────┬─────────┬───────────┬────────┬────────┐</span>
<span class="go">│ group ┆ item_id ┆ item_name ┆ value1 ┆ value2 │</span>
<span class="go">│ ---   ┆ ---     ┆ ---       ┆ ---    ┆ ---    │</span>
<span class="go">│ i64   ┆ i64     ┆ str       ┆ i64    ┆ i64    │</span>
<span class="go">╞═══════╪═════════╪═══════════╪════════╪════════╡</span>
<span class="go">│ 1     ┆ 1       ┆ a         ┆ 1      ┆ 4      │</span>
<span class="go">│ 1     ┆ 2       ┆ a         ┆ 0      ┆ 99     │</span>
<span class="go">│ 1     ┆ 2       ┆ b         ┆ 3      ┆ 6      │</span>
<span class="go">│ 1     ┆ 3       ┆ b         ┆ 0      ┆ 99     │</span>
<span class="go">│ 2     ┆ 1       ┆ a         ┆ 0      ┆ 99     │</span>
<span class="go">│ 2     ┆ 2       ┆ a         ┆ 0      ┆ 5      │</span>
<span class="go">│ 2     ┆ 2       ┆ b         ┆ 0      ┆ 99     │</span>
<span class="go">│ 2     ┆ 3       ┆ b         ┆ 4      ┆ 7      │</span>
<span class="go">└───────┴─────────┴───────────┴────────┴────────┘</span>
</code></pre></div>
    <p>Limit the fill to only the newly created
missing values with <code>explicit = FALSE</code>:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pl</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">tbl_rows</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">struct</span><span class="p">(</span><span class="s2">&quot;item_id&quot;</span><span class="p">,</span> <span class="s2">&quot;item_name&quot;</span><span class="p">),</span> <span class="s2">&quot;value1&quot;</span><span class="p">,</span> <span class="s2">&quot;value2&quot;</span>
<span class="gp">... </span>    <span class="p">)</span><span class="o">.</span><span class="n">complete</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s2">&quot;group&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;item_id&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">fill_value</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;value1&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;value2&quot;</span><span class="p">:</span> <span class="mi">99</span><span class="p">},</span>
<span class="gp">... </span>        <span class="n">explicit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">)</span><span class="o">.</span><span class="n">unnest</span><span class="p">(</span><span class="s2">&quot;item_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
<span class="go">shape: (8, 5)</span>
<span class="go">┌───────┬─────────┬───────────┬────────┬────────┐</span>
<span class="go">│ group ┆ item_id ┆ item_name ┆ value1 ┆ value2 │</span>
<span class="go">│ ---   ┆ ---     ┆ ---       ┆ ---    ┆ ---    │</span>
<span class="go">│ i64   ┆ i64     ┆ str       ┆ i64    ┆ i64    │</span>
<span class="go">╞═══════╪═════════╪═══════════╪════════╪════════╡</span>
<span class="go">│ 1     ┆ 1       ┆ a         ┆ 1      ┆ 4      │</span>
<span class="go">│ 1     ┆ 2       ┆ a         ┆ 0      ┆ 99     │</span>
<span class="go">│ 1     ┆ 2       ┆ b         ┆ 3      ┆ 6      │</span>
<span class="go">│ 1     ┆ 3       ┆ b         ┆ 0      ┆ 99     │</span>
<span class="go">│ 2     ┆ 1       ┆ a         ┆ 0      ┆ 99     │</span>
<span class="go">│ 2     ┆ 2       ┆ a         ┆ null   ┆ 5      │</span>
<span class="go">│ 2     ┆ 2       ┆ b         ┆ 0      ┆ 99     │</span>
<span class="go">│ 2     ┆ 3       ┆ b         ┆ 4      ┆ 7      │</span>
<span class="go">└───────┴─────────┴───────────┴────────┴────────┘</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;Year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1999</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">1999</span><span class="p">,</span> <span class="mi">2004</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;Taxon&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="gp">... </span>            <span class="s2">&quot;Saccharina&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;Saccharina&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;Saccharina&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;Agarum&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;Agarum&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;Abundance&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (5, 3)</span>
<span class="go">┌──────┬────────────┬───────────┐</span>
<span class="go">│ Year ┆ Taxon      ┆ Abundance │</span>
<span class="go">│ ---  ┆ ---        ┆ ---       │</span>
<span class="go">│ i64  ┆ str        ┆ i64       │</span>
<span class="go">╞══════╪════════════╪═══════════╡</span>
<span class="go">│ 1999 ┆ Saccharina ┆ 4         │</span>
<span class="go">│ 2000 ┆ Saccharina ┆ 5         │</span>
<span class="go">│ 2004 ┆ Saccharina ┆ 2         │</span>
<span class="go">│ 1999 ┆ Agarum     ┆ 1         │</span>
<span class="go">│ 2004 ┆ Agarum     ┆ 8         │</span>
<span class="go">└──────┴────────────┴───────────┘</span>
</code></pre></div>
    <p>Expose missing years from 1999 to 2004 -
pass a polars expression with the new dates,
and ensure the expression's name already exists
in the DataFrame:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">expression</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">int_range</span><span class="p">(</span><span class="mi">1999</span><span class="p">,</span><span class="mi">2005</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pl</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">tbl_rows</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">.</span><span class="n">complete</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span><span class="s1">&#39;Taxon&#39;</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">shape: (12, 3)</span>
<span class="go">┌──────┬────────────┬───────────┐</span>
<span class="go">│ Year ┆ Taxon      ┆ Abundance │</span>
<span class="go">│ ---  ┆ ---        ┆ ---       │</span>
<span class="go">│ i64  ┆ str        ┆ i64       │</span>
<span class="go">╞══════╪════════════╪═══════════╡</span>
<span class="go">│ 1999 ┆ Agarum     ┆ 1         │</span>
<span class="go">│ 1999 ┆ Saccharina ┆ 4         │</span>
<span class="go">│ 2000 ┆ Agarum     ┆ null      │</span>
<span class="go">│ 2000 ┆ Saccharina ┆ 5         │</span>
<span class="go">│ 2001 ┆ Agarum     ┆ null      │</span>
<span class="go">│ 2001 ┆ Saccharina ┆ null      │</span>
<span class="go">│ 2002 ┆ Agarum     ┆ null      │</span>
<span class="go">│ 2002 ┆ Saccharina ┆ null      │</span>
<span class="go">│ 2003 ┆ Agarum     ┆ null      │</span>
<span class="go">│ 2003 ┆ Saccharina ┆ null      │</span>
<span class="go">│ 2004 ┆ Agarum     ┆ 8         │</span>
<span class="go">│ 2004 ┆ Saccharina ┆ 2         │</span>
<span class="go">└──────┴────────────┴───────────┘</span>
</code></pre></div>
    <p>Expose missing rows per group:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;CA&quot;</span><span class="p">,</span> <span class="s2">&quot;CA&quot;</span><span class="p">,</span> <span class="s2">&quot;HI&quot;</span><span class="p">,</span> <span class="s2">&quot;HI&quot;</span><span class="p">,</span> <span class="s2">&quot;HI&quot;</span><span class="p">,</span> <span class="s2">&quot;NY&quot;</span><span class="p">,</span> <span class="s2">&quot;NY&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2016</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2013</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (7, 3)</span>
<span class="go">┌───────┬──────┬───────┐</span>
<span class="go">│ state ┆ year ┆ value │</span>
<span class="go">│ ---   ┆ ---  ┆ ---   │</span>
<span class="go">│ str   ┆ i64  ┆ i64   │</span>
<span class="go">╞═══════╪══════╪═══════╡</span>
<span class="go">│ CA    ┆ 2010 ┆ 1     │</span>
<span class="go">│ CA    ┆ 2013 ┆ 3     │</span>
<span class="go">│ HI    ┆ 2010 ┆ 1     │</span>
<span class="go">│ HI    ┆ 2012 ┆ 2     │</span>
<span class="go">│ HI    ┆ 2016 ┆ 3     │</span>
<span class="go">│ NY    ┆ 2009 ┆ 2     │</span>
<span class="go">│ NY    ┆ 2013 ┆ 5     │</span>
<span class="go">└───────┴──────┴───────┘</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">high</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_year_values</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">int_range</span><span class="p">(</span><span class="n">low</span><span class="p">,</span><span class="n">high</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pl</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">tbl_rows</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">.</span><span class="n">complete</span><span class="p">(</span><span class="n">new_year_values</span><span class="p">,</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">shape: (16, 3)</span>
<span class="go">┌───────┬──────┬───────┐</span>
<span class="go">│ state ┆ year ┆ value │</span>
<span class="go">│ ---   ┆ ---  ┆ ---   │</span>
<span class="go">│ str   ┆ i64  ┆ i64   │</span>
<span class="go">╞═══════╪══════╪═══════╡</span>
<span class="go">│ CA    ┆ 2010 ┆ 1     │</span>
<span class="go">│ CA    ┆ 2011 ┆ null  │</span>
<span class="go">│ CA    ┆ 2012 ┆ null  │</span>
<span class="go">│ CA    ┆ 2013 ┆ 3     │</span>
<span class="go">│ HI    ┆ 2010 ┆ 1     │</span>
<span class="go">│ HI    ┆ 2011 ┆ null  │</span>
<span class="go">│ HI    ┆ 2012 ┆ 2     │</span>
<span class="go">│ HI    ┆ 2013 ┆ null  │</span>
<span class="go">│ HI    ┆ 2014 ┆ null  │</span>
<span class="go">│ HI    ┆ 2015 ┆ null  │</span>
<span class="go">│ HI    ┆ 2016 ┆ 3     │</span>
<span class="go">│ NY    ┆ 2009 ┆ 2     │</span>
<span class="go">│ NY    ┆ 2010 ┆ null  │</span>
<span class="go">│ NY    ┆ 2011 ┆ null  │</span>
<span class="go">│ NY    ┆ 2012 ┆ null  │</span>
<span class="go">│ NY    ┆ 2013 ┆ 5     │</span>
<span class="go">└───────┴──────┴───────┘</span>
</code></pre></div>
        <div class="admonition info">
<p class="admonition-title">New in version 0.28.0</p>
</div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*columns</code>
            </td>
            <td>
                  <code>ColumnNameOrSelector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This refers to the columns to be completed.
It can be a string or a column selector or a polars expression.
A polars expression can be used to introduced new values,
as long as the polars expression has a name that already exists
in the DataFrame.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fill_value</code>
            </td>
            <td>
                  <code>dict | Any | Expr</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scalar value or polars expression to use instead of nulls
for missing combinations. A dictionary, mapping columns names
to a scalar value is also accepted.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>explicit</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Determines if only implicitly missing values
should be filled (<code>False</code>), or all nulls existing in the LazyFrame
(<code>True</code>). <code>explicit</code> is applicable only
if <code>fill_value</code> is not <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sort</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sort the DataFrame based on *columns.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>by</code>
            </td>
            <td>
                  <code>ColumnNameOrSelector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column(s) to group by.
The explicit missing rows are returned per group.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame | LazyFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A polars DataFrame/LazyFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>janitor/polars/complete.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@register_lazyframe_method</span>
<span class="nd">@register_dataframe_method</span>
<span class="k">def</span> <span class="nf">complete</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">,</span>
    <span class="o">*</span><span class="n">columns</span><span class="p">:</span> <span class="n">ColumnNameOrSelector</span><span class="p">,</span>
    <span class="n">fill_value</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">Any</span> <span class="o">|</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">explicit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">sort</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">by</span><span class="p">:</span> <span class="n">ColumnNameOrSelector</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Turns implicit missing values into explicit missing values</span>

<span class="sd">    It is modeled after tidyr&#39;s `complete` function.</span>
<span class="sd">    In a way, it is the inverse of `pl.drop_nulls`,</span>
<span class="sd">    as it exposes implicitly missing rows.</span>

<span class="sd">    If new values need to be introduced, a polars Expression</span>
<span class="sd">    or a polars Series with the new values can be passed,</span>
<span class="sd">    as long as the polars Expression/Series</span>
<span class="sd">    has a name that already exists in the DataFrame.</span>

<span class="sd">    `complete` can also be applied to a LazyFrame.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import polars as pl</span>
<span class="sd">        &gt;&gt;&gt; import janitor.polars</span>
<span class="sd">        &gt;&gt;&gt; df = pl.DataFrame(</span>
<span class="sd">        ...     dict(</span>
<span class="sd">        ...         group=(1, 2, 1, 2),</span>
<span class="sd">        ...         item_id=(1, 2, 2, 3),</span>
<span class="sd">        ...         item_name=(&quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;b&quot;),</span>
<span class="sd">        ...         value1=(1, None, 3, 4),</span>
<span class="sd">        ...         value2=range(4, 8),</span>
<span class="sd">        ...     )</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">        shape: (4, 5)</span>
<span class="sd">        ┌───────┬─────────┬───────────┬────────┬────────┐</span>
<span class="sd">        │ group ┆ item_id ┆ item_name ┆ value1 ┆ value2 │</span>
<span class="sd">        │ ---   ┆ ---     ┆ ---       ┆ ---    ┆ ---    │</span>
<span class="sd">        │ i64   ┆ i64     ┆ str       ┆ i64    ┆ i64    │</span>
<span class="sd">        ╞═══════╪═════════╪═══════════╪════════╪════════╡</span>
<span class="sd">        │ 1     ┆ 1       ┆ a         ┆ 1      ┆ 4      │</span>
<span class="sd">        │ 2     ┆ 2       ┆ a         ┆ null   ┆ 5      │</span>
<span class="sd">        │ 1     ┆ 2       ┆ b         ┆ 3      ┆ 6      │</span>
<span class="sd">        │ 2     ┆ 3       ┆ b         ┆ 4      ┆ 7      │</span>
<span class="sd">        └───────┴─────────┴───────────┴────────┴────────┘</span>

<span class="sd">        Generate all possible combinations of</span>
<span class="sd">        `group`, `item_id`, and `item_name`</span>
<span class="sd">        (whether or not they appear in the data)</span>
<span class="sd">        &gt;&gt;&gt; with pl.Config(tbl_rows=-1):</span>
<span class="sd">        ...     df.complete(&quot;group&quot;, &quot;item_id&quot;, &quot;item_name&quot;, sort=True)</span>
<span class="sd">        shape: (12, 5)</span>
<span class="sd">        ┌───────┬─────────┬───────────┬────────┬────────┐</span>
<span class="sd">        │ group ┆ item_id ┆ item_name ┆ value1 ┆ value2 │</span>
<span class="sd">        │ ---   ┆ ---     ┆ ---       ┆ ---    ┆ ---    │</span>
<span class="sd">        │ i64   ┆ i64     ┆ str       ┆ i64    ┆ i64    │</span>
<span class="sd">        ╞═══════╪═════════╪═══════════╪════════╪════════╡</span>
<span class="sd">        │ 1     ┆ 1       ┆ a         ┆ 1      ┆ 4      │</span>
<span class="sd">        │ 1     ┆ 1       ┆ b         ┆ null   ┆ null   │</span>
<span class="sd">        │ 1     ┆ 2       ┆ a         ┆ null   ┆ null   │</span>
<span class="sd">        │ 1     ┆ 2       ┆ b         ┆ 3      ┆ 6      │</span>
<span class="sd">        │ 1     ┆ 3       ┆ a         ┆ null   ┆ null   │</span>
<span class="sd">        │ 1     ┆ 3       ┆ b         ┆ null   ┆ null   │</span>
<span class="sd">        │ 2     ┆ 1       ┆ a         ┆ null   ┆ null   │</span>
<span class="sd">        │ 2     ┆ 1       ┆ b         ┆ null   ┆ null   │</span>
<span class="sd">        │ 2     ┆ 2       ┆ a         ┆ null   ┆ 5      │</span>
<span class="sd">        │ 2     ┆ 2       ┆ b         ┆ null   ┆ null   │</span>
<span class="sd">        │ 2     ┆ 3       ┆ a         ┆ null   ┆ null   │</span>
<span class="sd">        │ 2     ┆ 3       ┆ b         ┆ 4      ┆ 7      │</span>
<span class="sd">        └───────┴─────────┴───────────┴────────┴────────┘</span>

<span class="sd">        Cross all possible `group` values with the unique pairs of</span>
<span class="sd">        `(item_id, item_name)` that already exist in the data.</span>
<span class="sd">        &gt;&gt;&gt; with pl.Config(tbl_rows=-1):</span>
<span class="sd">        ...     df.select(</span>
<span class="sd">        ...         &quot;group&quot;, pl.struct(&quot;item_id&quot;, &quot;item_name&quot;), &quot;value1&quot;, &quot;value2&quot;</span>
<span class="sd">        ...     ).complete(&quot;group&quot;, &quot;item_id&quot;, sort=True).unnest(&quot;item_id&quot;)</span>
<span class="sd">        shape: (8, 5)</span>
<span class="sd">        ┌───────┬─────────┬───────────┬────────┬────────┐</span>
<span class="sd">        │ group ┆ item_id ┆ item_name ┆ value1 ┆ value2 │</span>
<span class="sd">        │ ---   ┆ ---     ┆ ---       ┆ ---    ┆ ---    │</span>
<span class="sd">        │ i64   ┆ i64     ┆ str       ┆ i64    ┆ i64    │</span>
<span class="sd">        ╞═══════╪═════════╪═══════════╪════════╪════════╡</span>
<span class="sd">        │ 1     ┆ 1       ┆ a         ┆ 1      ┆ 4      │</span>
<span class="sd">        │ 1     ┆ 2       ┆ a         ┆ null   ┆ null   │</span>
<span class="sd">        │ 1     ┆ 2       ┆ b         ┆ 3      ┆ 6      │</span>
<span class="sd">        │ 1     ┆ 3       ┆ b         ┆ null   ┆ null   │</span>
<span class="sd">        │ 2     ┆ 1       ┆ a         ┆ null   ┆ null   │</span>
<span class="sd">        │ 2     ┆ 2       ┆ a         ┆ null   ┆ 5      │</span>
<span class="sd">        │ 2     ┆ 2       ┆ b         ┆ null   ┆ null   │</span>
<span class="sd">        │ 2     ┆ 3       ┆ b         ┆ 4      ┆ 7      │</span>
<span class="sd">        └───────┴─────────┴───────────┴────────┴────────┘</span>

<span class="sd">        Fill in nulls:</span>
<span class="sd">        &gt;&gt;&gt; with pl.Config(tbl_rows=-1):</span>
<span class="sd">        ...     df.select(</span>
<span class="sd">        ...         &quot;group&quot;, pl.struct(&quot;item_id&quot;, &quot;item_name&quot;), &quot;value1&quot;, &quot;value2&quot;</span>
<span class="sd">        ...     ).complete(</span>
<span class="sd">        ...         &quot;group&quot;,</span>
<span class="sd">        ...         &quot;item_id&quot;,</span>
<span class="sd">        ...         fill_value={&quot;value1&quot;: 0, &quot;value2&quot;: 99},</span>
<span class="sd">        ...         explicit=True,</span>
<span class="sd">        ...         sort=True,</span>
<span class="sd">        ...     ).unnest(&quot;item_id&quot;)</span>
<span class="sd">        shape: (8, 5)</span>
<span class="sd">        ┌───────┬─────────┬───────────┬────────┬────────┐</span>
<span class="sd">        │ group ┆ item_id ┆ item_name ┆ value1 ┆ value2 │</span>
<span class="sd">        │ ---   ┆ ---     ┆ ---       ┆ ---    ┆ ---    │</span>
<span class="sd">        │ i64   ┆ i64     ┆ str       ┆ i64    ┆ i64    │</span>
<span class="sd">        ╞═══════╪═════════╪═══════════╪════════╪════════╡</span>
<span class="sd">        │ 1     ┆ 1       ┆ a         ┆ 1      ┆ 4      │</span>
<span class="sd">        │ 1     ┆ 2       ┆ a         ┆ 0      ┆ 99     │</span>
<span class="sd">        │ 1     ┆ 2       ┆ b         ┆ 3      ┆ 6      │</span>
<span class="sd">        │ 1     ┆ 3       ┆ b         ┆ 0      ┆ 99     │</span>
<span class="sd">        │ 2     ┆ 1       ┆ a         ┆ 0      ┆ 99     │</span>
<span class="sd">        │ 2     ┆ 2       ┆ a         ┆ 0      ┆ 5      │</span>
<span class="sd">        │ 2     ┆ 2       ┆ b         ┆ 0      ┆ 99     │</span>
<span class="sd">        │ 2     ┆ 3       ┆ b         ┆ 4      ┆ 7      │</span>
<span class="sd">        └───────┴─────────┴───────────┴────────┴────────┘</span>

<span class="sd">        Limit the fill to only the newly created</span>
<span class="sd">        missing values with `explicit = FALSE`:</span>
<span class="sd">        &gt;&gt;&gt; with pl.Config(tbl_rows=-1):</span>
<span class="sd">        ...     df.select(</span>
<span class="sd">        ...         &quot;group&quot;, pl.struct(&quot;item_id&quot;, &quot;item_name&quot;), &quot;value1&quot;, &quot;value2&quot;</span>
<span class="sd">        ...     ).complete(</span>
<span class="sd">        ...         &quot;group&quot;,</span>
<span class="sd">        ...         &quot;item_id&quot;,</span>
<span class="sd">        ...         fill_value={&quot;value1&quot;: 0, &quot;value2&quot;: 99},</span>
<span class="sd">        ...         explicit=False,</span>
<span class="sd">        ...         sort=True,</span>
<span class="sd">        ...     ).unnest(&quot;item_id&quot;).sort(pl.all())</span>
<span class="sd">        shape: (8, 5)</span>
<span class="sd">        ┌───────┬─────────┬───────────┬────────┬────────┐</span>
<span class="sd">        │ group ┆ item_id ┆ item_name ┆ value1 ┆ value2 │</span>
<span class="sd">        │ ---   ┆ ---     ┆ ---       ┆ ---    ┆ ---    │</span>
<span class="sd">        │ i64   ┆ i64     ┆ str       ┆ i64    ┆ i64    │</span>
<span class="sd">        ╞═══════╪═════════╪═══════════╪════════╪════════╡</span>
<span class="sd">        │ 1     ┆ 1       ┆ a         ┆ 1      ┆ 4      │</span>
<span class="sd">        │ 1     ┆ 2       ┆ a         ┆ 0      ┆ 99     │</span>
<span class="sd">        │ 1     ┆ 2       ┆ b         ┆ 3      ┆ 6      │</span>
<span class="sd">        │ 1     ┆ 3       ┆ b         ┆ 0      ┆ 99     │</span>
<span class="sd">        │ 2     ┆ 1       ┆ a         ┆ 0      ┆ 99     │</span>
<span class="sd">        │ 2     ┆ 2       ┆ a         ┆ null   ┆ 5      │</span>
<span class="sd">        │ 2     ┆ 2       ┆ b         ┆ 0      ┆ 99     │</span>
<span class="sd">        │ 2     ┆ 3       ┆ b         ┆ 4      ┆ 7      │</span>
<span class="sd">        └───────┴─────────┴───────────┴────────┴────────┘</span>

<span class="sd">        &gt;&gt;&gt; df = pl.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...         &quot;Year&quot;: [1999, 2000, 2004, 1999, 2004],</span>
<span class="sd">        ...         &quot;Taxon&quot;: [</span>
<span class="sd">        ...             &quot;Saccharina&quot;,</span>
<span class="sd">        ...             &quot;Saccharina&quot;,</span>
<span class="sd">        ...             &quot;Saccharina&quot;,</span>
<span class="sd">        ...             &quot;Agarum&quot;,</span>
<span class="sd">        ...             &quot;Agarum&quot;,</span>
<span class="sd">        ...         ],</span>
<span class="sd">        ...         &quot;Abundance&quot;: [4, 5, 2, 1, 8],</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">        shape: (5, 3)</span>
<span class="sd">        ┌──────┬────────────┬───────────┐</span>
<span class="sd">        │ Year ┆ Taxon      ┆ Abundance │</span>
<span class="sd">        │ ---  ┆ ---        ┆ ---       │</span>
<span class="sd">        │ i64  ┆ str        ┆ i64       │</span>
<span class="sd">        ╞══════╪════════════╪═══════════╡</span>
<span class="sd">        │ 1999 ┆ Saccharina ┆ 4         │</span>
<span class="sd">        │ 2000 ┆ Saccharina ┆ 5         │</span>
<span class="sd">        │ 2004 ┆ Saccharina ┆ 2         │</span>
<span class="sd">        │ 1999 ┆ Agarum     ┆ 1         │</span>
<span class="sd">        │ 2004 ┆ Agarum     ┆ 8         │</span>
<span class="sd">        └──────┴────────────┴───────────┘</span>

<span class="sd">        Expose missing years from 1999 to 2004 -</span>
<span class="sd">        pass a polars expression with the new dates,</span>
<span class="sd">        and ensure the expression&#39;s name already exists</span>
<span class="sd">        in the DataFrame:</span>
<span class="sd">        &gt;&gt;&gt; expression = pl.int_range(1999,2005).alias(&#39;Year&#39;)</span>
<span class="sd">        &gt;&gt;&gt; with pl.Config(tbl_rows=-1):</span>
<span class="sd">        ...     df.complete(expression,&#39;Taxon&#39;,sort=True)</span>
<span class="sd">        shape: (12, 3)</span>
<span class="sd">        ┌──────┬────────────┬───────────┐</span>
<span class="sd">        │ Year ┆ Taxon      ┆ Abundance │</span>
<span class="sd">        │ ---  ┆ ---        ┆ ---       │</span>
<span class="sd">        │ i64  ┆ str        ┆ i64       │</span>
<span class="sd">        ╞══════╪════════════╪═══════════╡</span>
<span class="sd">        │ 1999 ┆ Agarum     ┆ 1         │</span>
<span class="sd">        │ 1999 ┆ Saccharina ┆ 4         │</span>
<span class="sd">        │ 2000 ┆ Agarum     ┆ null      │</span>
<span class="sd">        │ 2000 ┆ Saccharina ┆ 5         │</span>
<span class="sd">        │ 2001 ┆ Agarum     ┆ null      │</span>
<span class="sd">        │ 2001 ┆ Saccharina ┆ null      │</span>
<span class="sd">        │ 2002 ┆ Agarum     ┆ null      │</span>
<span class="sd">        │ 2002 ┆ Saccharina ┆ null      │</span>
<span class="sd">        │ 2003 ┆ Agarum     ┆ null      │</span>
<span class="sd">        │ 2003 ┆ Saccharina ┆ null      │</span>
<span class="sd">        │ 2004 ┆ Agarum     ┆ 8         │</span>
<span class="sd">        │ 2004 ┆ Saccharina ┆ 2         │</span>
<span class="sd">        └──────┴────────────┴───────────┘</span>

<span class="sd">        Expose missing rows per group:</span>
<span class="sd">        &gt;&gt;&gt; df = pl.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...         &quot;state&quot;: [&quot;CA&quot;, &quot;CA&quot;, &quot;HI&quot;, &quot;HI&quot;, &quot;HI&quot;, &quot;NY&quot;, &quot;NY&quot;],</span>
<span class="sd">        ...         &quot;year&quot;: [2010, 2013, 2010, 2012, 2016, 2009, 2013],</span>
<span class="sd">        ...         &quot;value&quot;: [1, 3, 1, 2, 3, 2, 5],</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">        shape: (7, 3)</span>
<span class="sd">        ┌───────┬──────┬───────┐</span>
<span class="sd">        │ state ┆ year ┆ value │</span>
<span class="sd">        │ ---   ┆ ---  ┆ ---   │</span>
<span class="sd">        │ str   ┆ i64  ┆ i64   │</span>
<span class="sd">        ╞═══════╪══════╪═══════╡</span>
<span class="sd">        │ CA    ┆ 2010 ┆ 1     │</span>
<span class="sd">        │ CA    ┆ 2013 ┆ 3     │</span>
<span class="sd">        │ HI    ┆ 2010 ┆ 1     │</span>
<span class="sd">        │ HI    ┆ 2012 ┆ 2     │</span>
<span class="sd">        │ HI    ┆ 2016 ┆ 3     │</span>
<span class="sd">        │ NY    ┆ 2009 ┆ 2     │</span>
<span class="sd">        │ NY    ┆ 2013 ┆ 5     │</span>
<span class="sd">        └───────┴──────┴───────┘</span>
<span class="sd">        &gt;&gt;&gt; low = pl.col(&#39;year&#39;).min()</span>
<span class="sd">        &gt;&gt;&gt; high = pl.col(&#39;year&#39;).max().add(1)</span>
<span class="sd">        &gt;&gt;&gt; new_year_values=pl.int_range(low,high).alias(&#39;year&#39;)</span>
<span class="sd">        &gt;&gt;&gt; with pl.Config(tbl_rows=-1):</span>
<span class="sd">        ...     df.complete(new_year_values,by=&#39;state&#39;,sort=True)</span>
<span class="sd">        shape: (16, 3)</span>
<span class="sd">        ┌───────┬──────┬───────┐</span>
<span class="sd">        │ state ┆ year ┆ value │</span>
<span class="sd">        │ ---   ┆ ---  ┆ ---   │</span>
<span class="sd">        │ str   ┆ i64  ┆ i64   │</span>
<span class="sd">        ╞═══════╪══════╪═══════╡</span>
<span class="sd">        │ CA    ┆ 2010 ┆ 1     │</span>
<span class="sd">        │ CA    ┆ 2011 ┆ null  │</span>
<span class="sd">        │ CA    ┆ 2012 ┆ null  │</span>
<span class="sd">        │ CA    ┆ 2013 ┆ 3     │</span>
<span class="sd">        │ HI    ┆ 2010 ┆ 1     │</span>
<span class="sd">        │ HI    ┆ 2011 ┆ null  │</span>
<span class="sd">        │ HI    ┆ 2012 ┆ 2     │</span>
<span class="sd">        │ HI    ┆ 2013 ┆ null  │</span>
<span class="sd">        │ HI    ┆ 2014 ┆ null  │</span>
<span class="sd">        │ HI    ┆ 2015 ┆ null  │</span>
<span class="sd">        │ HI    ┆ 2016 ┆ 3     │</span>
<span class="sd">        │ NY    ┆ 2009 ┆ 2     │</span>
<span class="sd">        │ NY    ┆ 2010 ┆ null  │</span>
<span class="sd">        │ NY    ┆ 2011 ┆ null  │</span>
<span class="sd">        │ NY    ┆ 2012 ┆ null  │</span>
<span class="sd">        │ NY    ┆ 2013 ┆ 5     │</span>
<span class="sd">        └───────┴──────┴───────┘</span>


<span class="sd">    !!! info &quot;New in version 0.28.0&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        *columns: This refers to the columns to be completed.</span>
<span class="sd">            It can be a string or a column selector or a polars expression.</span>
<span class="sd">            A polars expression can be used to introduced new values,</span>
<span class="sd">            as long as the polars expression has a name that already exists</span>
<span class="sd">            in the DataFrame.</span>
<span class="sd">        fill_value: Scalar value or polars expression to use instead of nulls</span>
<span class="sd">            for missing combinations. A dictionary, mapping columns names</span>
<span class="sd">            to a scalar value is also accepted.</span>
<span class="sd">        explicit: Determines if only implicitly missing values</span>
<span class="sd">            should be filled (`False`), or all nulls existing in the LazyFrame</span>
<span class="sd">            (`True`). `explicit` is applicable only</span>
<span class="sd">            if `fill_value` is not `None`.</span>
<span class="sd">        sort: Sort the DataFrame based on *columns.</span>
<span class="sd">        by: Column(s) to group by.</span>
<span class="sd">            The explicit missing rows are returned per group.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A polars DataFrame/LazyFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">columns</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span>
    <span class="k">return</span> <span class="n">_complete</span><span class="p">(</span>
        <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
        <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">,</span>
        <span class="n">explicit</span><span class="o">=</span><span class="n">explicit</span><span class="p">,</span>
        <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">,</span>
        <span class="n">by</span><span class="o">=</span><span class="n">by</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="janitor.polars.complete.expand" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">expand</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">*</span><span class="n">columns</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Creates a DataFrame from a cartesian combination of all inputs.</p>
<p>Inspiration is from tidyr's expand() function.</p>
<p>expand() is often useful with
<a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.join.html">pl.DataFrame.join</a>
to convert implicit
missing values to explicit missing values - similar to
<a class="autorefs autorefs-internal" href="#janitor.polars.complete.complete"><code>complete</code></a>.</p>
<p>It can also be used to figure out which combinations are missing
(e.g identify gaps in your DataFrame).</p>
<p>The variable <code>columns</code> parameter can be a string,
a ColumnSelector, a polars expression, or a polars Series.</p>
<p><code>expand</code> can also be applied to a LazyFrame.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">janitor.polars</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2010</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="s1">&#39;XS&#39;</span><span class="p">},</span>
<span class="gp">... </span>        <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2010</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="p">},</span>
<span class="gp">... </span>        <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2012</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="s1">&#39;M&#39;</span><span class="p">},</span>
<span class="gp">... </span>        <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2010</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="p">},</span>
<span class="gp">... </span>        <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2011</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="p">},</span>
<span class="gp">... </span>        <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2012</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="s1">&#39;M&#39;</span><span class="p">}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (6, 3)</span>
<span class="go">┌────────┬──────┬──────┐</span>
<span class="go">│ type   ┆ year ┆ size │</span>
<span class="go">│ ---    ┆ ---  ┆ ---  │</span>
<span class="go">│ str    ┆ i64  ┆ str  │</span>
<span class="go">╞════════╪══════╪══════╡</span>
<span class="go">│ apple  ┆ 2010 ┆ XS   │</span>
<span class="go">│ orange ┆ 2010 ┆ S    │</span>
<span class="go">│ apple  ┆ 2012 ┆ M    │</span>
<span class="go">│ orange ┆ 2010 ┆ S    │</span>
<span class="go">│ orange ┆ 2011 ┆ S    │</span>
<span class="go">│ orange ┆ 2012 ┆ M    │</span>
<span class="go">└────────┴──────┴──────┘</span>
</code></pre></div>
    <p>Get unique observations:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">shape: (2, 1)</span>
<span class="go">┌────────┐</span>
<span class="go">│ type   │</span>
<span class="go">│ ---    │</span>
<span class="go">│ str    │</span>
<span class="go">╞════════╡</span>
<span class="go">│ apple  │</span>
<span class="go">│ orange │</span>
<span class="go">└────────┘</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">shape: (3, 1)</span>
<span class="go">┌──────┐</span>
<span class="go">│ size │</span>
<span class="go">│ ---  │</span>
<span class="go">│ str  │</span>
<span class="go">╞══════╡</span>
<span class="go">│ M    │</span>
<span class="go">│ S    │</span>
<span class="go">│ XS   │</span>
<span class="go">└──────┘</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go">┌────────┬──────┐</span>
<span class="go">│ type   ┆ size │</span>
<span class="go">│ ---    ┆ ---  │</span>
<span class="go">│ str    ┆ str  │</span>
<span class="go">╞════════╪══════╡</span>
<span class="go">│ apple  ┆ M    │</span>
<span class="go">│ apple  ┆ S    │</span>
<span class="go">│ apple  ┆ XS   │</span>
<span class="go">│ orange ┆ M    │</span>
<span class="go">│ orange ┆ S    │</span>
<span class="go">│ orange ┆ XS   │</span>
<span class="go">└────────┴──────┘</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pl</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">tbl_rows</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="s1">&#39;size&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">shape: (18, 3)</span>
<span class="go">┌────────┬──────┬──────┐</span>
<span class="go">│ type   ┆ size ┆ year │</span>
<span class="go">│ ---    ┆ ---  ┆ ---  │</span>
<span class="go">│ str    ┆ str  ┆ i64  │</span>
<span class="go">╞════════╪══════╪══════╡</span>
<span class="go">│ apple  ┆ M    ┆ 2010 │</span>
<span class="go">│ apple  ┆ M    ┆ 2011 │</span>
<span class="go">│ apple  ┆ M    ┆ 2012 │</span>
<span class="go">│ apple  ┆ S    ┆ 2010 │</span>
<span class="go">│ apple  ┆ S    ┆ 2011 │</span>
<span class="go">│ apple  ┆ S    ┆ 2012 │</span>
<span class="go">│ apple  ┆ XS   ┆ 2010 │</span>
<span class="go">│ apple  ┆ XS   ┆ 2011 │</span>
<span class="go">│ apple  ┆ XS   ┆ 2012 │</span>
<span class="go">│ orange ┆ M    ┆ 2010 │</span>
<span class="go">│ orange ┆ M    ┆ 2011 │</span>
<span class="go">│ orange ┆ M    ┆ 2012 │</span>
<span class="go">│ orange ┆ S    ┆ 2010 │</span>
<span class="go">│ orange ┆ S    ┆ 2011 │</span>
<span class="go">│ orange ┆ S    ┆ 2012 │</span>
<span class="go">│ orange ┆ XS   ┆ 2010 │</span>
<span class="go">│ orange ┆ XS   ┆ 2011 │</span>
<span class="go">│ orange ┆ XS   ┆ 2012 │</span>
<span class="go">└────────┴──────┴──────┘</span>
</code></pre></div>
    <p>Get observations that only occur in the data:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">struct</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="s1">&#39;size&#39;</span><span class="p">),</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">unnest</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>
<span class="go">shape: (4, 2)</span>
<span class="go">┌────────┬──────┐</span>
<span class="go">│ type   ┆ size │</span>
<span class="go">│ ---    ┆ ---  │</span>
<span class="go">│ str    ┆ str  │</span>
<span class="go">╞════════╪══════╡</span>
<span class="go">│ apple  ┆ M    │</span>
<span class="go">│ apple  ┆ XS   │</span>
<span class="go">│ orange ┆ M    │</span>
<span class="go">│ orange ┆ S    │</span>
<span class="go">└────────┴──────┘</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">struct</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="s1">&#39;size&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">),</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">unnest</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>
<span class="go">shape: (5, 3)</span>
<span class="go">┌────────┬──────┬──────┐</span>
<span class="go">│ type   ┆ size ┆ year │</span>
<span class="go">│ ---    ┆ ---  ┆ ---  │</span>
<span class="go">│ str    ┆ str  ┆ i64  │</span>
<span class="go">╞════════╪══════╪══════╡</span>
<span class="go">│ apple  ┆ M    ┆ 2012 │</span>
<span class="go">│ apple  ┆ XS   ┆ 2010 │</span>
<span class="go">│ orange ┆ M    ┆ 2012 │</span>
<span class="go">│ orange ┆ S    ┆ 2010 │</span>
<span class="go">│ orange ┆ S    ┆ 2011 │</span>
<span class="go">└────────┴──────┴──────┘</span>
</code></pre></div>
    <p>Expand the DataFrame to include new observations:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pl</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">tbl_rows</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="s1">&#39;size&#39;</span><span class="p">,</span><span class="n">pl</span><span class="o">.</span><span class="n">int_range</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span><span class="mi">2014</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;new_year&#39;</span><span class="p">),</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">shape: (24, 3)</span>
<span class="go">┌────────┬──────┬──────────┐</span>
<span class="go">│ type   ┆ size ┆ new_year │</span>
<span class="go">│ ---    ┆ ---  ┆ ---      │</span>
<span class="go">│ str    ┆ str  ┆ i64      │</span>
<span class="go">╞════════╪══════╪══════════╡</span>
<span class="go">│ apple  ┆ M    ┆ 2010     │</span>
<span class="go">│ apple  ┆ M    ┆ 2011     │</span>
<span class="go">│ apple  ┆ M    ┆ 2012     │</span>
<span class="go">│ apple  ┆ M    ┆ 2013     │</span>
<span class="go">│ apple  ┆ S    ┆ 2010     │</span>
<span class="go">│ apple  ┆ S    ┆ 2011     │</span>
<span class="go">│ apple  ┆ S    ┆ 2012     │</span>
<span class="go">│ apple  ┆ S    ┆ 2013     │</span>
<span class="go">│ apple  ┆ XS   ┆ 2010     │</span>
<span class="go">│ apple  ┆ XS   ┆ 2011     │</span>
<span class="go">│ apple  ┆ XS   ┆ 2012     │</span>
<span class="go">│ apple  ┆ XS   ┆ 2013     │</span>
<span class="go">│ orange ┆ M    ┆ 2010     │</span>
<span class="go">│ orange ┆ M    ┆ 2011     │</span>
<span class="go">│ orange ┆ M    ┆ 2012     │</span>
<span class="go">│ orange ┆ M    ┆ 2013     │</span>
<span class="go">│ orange ┆ S    ┆ 2010     │</span>
<span class="go">│ orange ┆ S    ┆ 2011     │</span>
<span class="go">│ orange ┆ S    ┆ 2012     │</span>
<span class="go">│ orange ┆ S    ┆ 2013     │</span>
<span class="go">│ orange ┆ XS   ┆ 2010     │</span>
<span class="go">│ orange ┆ XS   ┆ 2011     │</span>
<span class="go">│ orange ┆ XS   ┆ 2012     │</span>
<span class="go">│ orange ┆ XS   ┆ 2013     │</span>
<span class="go">└────────┴──────┴──────────┘</span>
</code></pre></div>
    <p>Filter for missing observations:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">columns</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="s1">&#39;size&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pl</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">tbl_rows</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="o">*</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;anti&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
<span class="go">shape: (13, 3)</span>
<span class="go">┌────────┬──────┬──────┐</span>
<span class="go">│ type   ┆ size ┆ year │</span>
<span class="go">│ ---    ┆ ---  ┆ ---  │</span>
<span class="go">│ str    ┆ str  ┆ i64  │</span>
<span class="go">╞════════╪══════╪══════╡</span>
<span class="go">│ apple  ┆ M    ┆ 2010 │</span>
<span class="go">│ apple  ┆ M    ┆ 2011 │</span>
<span class="go">│ apple  ┆ S    ┆ 2010 │</span>
<span class="go">│ apple  ┆ S    ┆ 2011 │</span>
<span class="go">│ apple  ┆ S    ┆ 2012 │</span>
<span class="go">│ apple  ┆ XS   ┆ 2011 │</span>
<span class="go">│ apple  ┆ XS   ┆ 2012 │</span>
<span class="go">│ orange ┆ M    ┆ 2010 │</span>
<span class="go">│ orange ┆ M    ┆ 2011 │</span>
<span class="go">│ orange ┆ S    ┆ 2012 │</span>
<span class="go">│ orange ┆ XS   ┆ 2010 │</span>
<span class="go">│ orange ┆ XS   ┆ 2011 │</span>
<span class="go">│ orange ┆ XS   ┆ 2012 │</span>
<span class="go">└────────┴──────┴──────┘</span>
</code></pre></div>
    <p>Expand within each group, using <code>by</code>:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pl</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">tbl_rows</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;size&#39;</span><span class="p">,</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">shape: (10, 3)</span>
<span class="go">┌────────┬──────┬──────┐</span>
<span class="go">│ type   ┆ year ┆ size │</span>
<span class="go">│ ---    ┆ ---  ┆ ---  │</span>
<span class="go">│ str    ┆ i64  ┆ str  │</span>
<span class="go">╞════════╪══════╪══════╡</span>
<span class="go">│ apple  ┆ 2010 ┆ M    │</span>
<span class="go">│ apple  ┆ 2010 ┆ XS   │</span>
<span class="go">│ apple  ┆ 2012 ┆ M    │</span>
<span class="go">│ apple  ┆ 2012 ┆ XS   │</span>
<span class="go">│ orange ┆ 2010 ┆ M    │</span>
<span class="go">│ orange ┆ 2010 ┆ S    │</span>
<span class="go">│ orange ┆ 2011 ┆ M    │</span>
<span class="go">│ orange ┆ 2011 ┆ S    │</span>
<span class="go">│ orange ┆ 2012 ┆ M    │</span>
<span class="go">│ orange ┆ 2012 ┆ S    │</span>
<span class="go">└────────┴──────┴──────┘</span>
</code></pre></div>
        <div class="admonition info">
<p class="admonition-title">New in version 0.28.0</p>
</div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*columns</code>
            </td>
            <td>
                  <code>ColumnNameOrSelector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This refers to the columns to be completed.
It can be a string or a column selector or a polars expression.
A polars expression can be used to introduced new values,
as long as the polars expression has a name that already exists
in the DataFrame.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sort</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sort the DataFrame based on *columns.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>by</code>
            </td>
            <td>
                  <code>ColumnNameOrSelector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column(s) to group by.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame | LazyFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A polars DataFrame/LazyFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>janitor/polars/complete.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@register_lazyframe_method</span>
<span class="nd">@register_dataframe_method</span>
<span class="k">def</span> <span class="nf">expand</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">,</span>
    <span class="o">*</span><span class="n">columns</span><span class="p">:</span> <span class="n">ColumnNameOrSelector</span><span class="p">,</span>
    <span class="n">sort</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">by</span><span class="p">:</span> <span class="n">ColumnNameOrSelector</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a DataFrame from a cartesian combination of all inputs.</span>

<span class="sd">    Inspiration is from tidyr&#39;s expand() function.</span>

<span class="sd">    expand() is often useful with</span>
<span class="sd">    [pl.DataFrame.join](https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.join.html)</span>
<span class="sd">    to convert implicit</span>
<span class="sd">    missing values to explicit missing values - similar to</span>
<span class="sd">    [`complete`][janitor.polars.complete.complete].</span>

<span class="sd">    It can also be used to figure out which combinations are missing</span>
<span class="sd">    (e.g identify gaps in your DataFrame).</span>

<span class="sd">    The variable `columns` parameter can be a string,</span>
<span class="sd">    a ColumnSelector, a polars expression, or a polars Series.</span>

<span class="sd">    `expand` can also be applied to a LazyFrame.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import polars as pl</span>
<span class="sd">        &gt;&gt;&gt; import janitor.polars</span>
<span class="sd">        &gt;&gt;&gt; data = [{&#39;type&#39;: &#39;apple&#39;, &#39;year&#39;: 2010, &#39;size&#39;: &#39;XS&#39;},</span>
<span class="sd">        ...         {&#39;type&#39;: &#39;orange&#39;, &#39;year&#39;: 2010, &#39;size&#39;: &#39;S&#39;},</span>
<span class="sd">        ...         {&#39;type&#39;: &#39;apple&#39;, &#39;year&#39;: 2012, &#39;size&#39;: &#39;M&#39;},</span>
<span class="sd">        ...         {&#39;type&#39;: &#39;orange&#39;, &#39;year&#39;: 2010, &#39;size&#39;: &#39;S&#39;},</span>
<span class="sd">        ...         {&#39;type&#39;: &#39;orange&#39;, &#39;year&#39;: 2011, &#39;size&#39;: &#39;S&#39;},</span>
<span class="sd">        ...         {&#39;type&#39;: &#39;orange&#39;, &#39;year&#39;: 2012, &#39;size&#39;: &#39;M&#39;}]</span>
<span class="sd">        &gt;&gt;&gt; df = pl.DataFrame(data)</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">        shape: (6, 3)</span>
<span class="sd">        ┌────────┬──────┬──────┐</span>
<span class="sd">        │ type   ┆ year ┆ size │</span>
<span class="sd">        │ ---    ┆ ---  ┆ ---  │</span>
<span class="sd">        │ str    ┆ i64  ┆ str  │</span>
<span class="sd">        ╞════════╪══════╪══════╡</span>
<span class="sd">        │ apple  ┆ 2010 ┆ XS   │</span>
<span class="sd">        │ orange ┆ 2010 ┆ S    │</span>
<span class="sd">        │ apple  ┆ 2012 ┆ M    │</span>
<span class="sd">        │ orange ┆ 2010 ┆ S    │</span>
<span class="sd">        │ orange ┆ 2011 ┆ S    │</span>
<span class="sd">        │ orange ┆ 2012 ┆ M    │</span>
<span class="sd">        └────────┴──────┴──────┘</span>

<span class="sd">        Get unique observations:</span>
<span class="sd">        &gt;&gt;&gt; df.expand(&#39;type&#39;,sort=True)</span>
<span class="sd">        shape: (2, 1)</span>
<span class="sd">        ┌────────┐</span>
<span class="sd">        │ type   │</span>
<span class="sd">        │ ---    │</span>
<span class="sd">        │ str    │</span>
<span class="sd">        ╞════════╡</span>
<span class="sd">        │ apple  │</span>
<span class="sd">        │ orange │</span>
<span class="sd">        └────────┘</span>
<span class="sd">        &gt;&gt;&gt; df.expand(&#39;size&#39;,sort=True)</span>
<span class="sd">        shape: (3, 1)</span>
<span class="sd">        ┌──────┐</span>
<span class="sd">        │ size │</span>
<span class="sd">        │ ---  │</span>
<span class="sd">        │ str  │</span>
<span class="sd">        ╞══════╡</span>
<span class="sd">        │ M    │</span>
<span class="sd">        │ S    │</span>
<span class="sd">        │ XS   │</span>
<span class="sd">        └──────┘</span>
<span class="sd">        &gt;&gt;&gt; df.expand(&#39;type&#39;, &#39;size&#39;,sort=True)</span>
<span class="sd">        shape: (6, 2)</span>
<span class="sd">        ┌────────┬──────┐</span>
<span class="sd">        │ type   ┆ size │</span>
<span class="sd">        │ ---    ┆ ---  │</span>
<span class="sd">        │ str    ┆ str  │</span>
<span class="sd">        ╞════════╪══════╡</span>
<span class="sd">        │ apple  ┆ M    │</span>
<span class="sd">        │ apple  ┆ S    │</span>
<span class="sd">        │ apple  ┆ XS   │</span>
<span class="sd">        │ orange ┆ M    │</span>
<span class="sd">        │ orange ┆ S    │</span>
<span class="sd">        │ orange ┆ XS   │</span>
<span class="sd">        └────────┴──────┘</span>
<span class="sd">        &gt;&gt;&gt; with pl.Config(tbl_rows=-1):</span>
<span class="sd">        ...     df.expand(&#39;type&#39;,&#39;size&#39;,&#39;year&#39;,sort=True)</span>
<span class="sd">        shape: (18, 3)</span>
<span class="sd">        ┌────────┬──────┬──────┐</span>
<span class="sd">        │ type   ┆ size ┆ year │</span>
<span class="sd">        │ ---    ┆ ---  ┆ ---  │</span>
<span class="sd">        │ str    ┆ str  ┆ i64  │</span>
<span class="sd">        ╞════════╪══════╪══════╡</span>
<span class="sd">        │ apple  ┆ M    ┆ 2010 │</span>
<span class="sd">        │ apple  ┆ M    ┆ 2011 │</span>
<span class="sd">        │ apple  ┆ M    ┆ 2012 │</span>
<span class="sd">        │ apple  ┆ S    ┆ 2010 │</span>
<span class="sd">        │ apple  ┆ S    ┆ 2011 │</span>
<span class="sd">        │ apple  ┆ S    ┆ 2012 │</span>
<span class="sd">        │ apple  ┆ XS   ┆ 2010 │</span>
<span class="sd">        │ apple  ┆ XS   ┆ 2011 │</span>
<span class="sd">        │ apple  ┆ XS   ┆ 2012 │</span>
<span class="sd">        │ orange ┆ M    ┆ 2010 │</span>
<span class="sd">        │ orange ┆ M    ┆ 2011 │</span>
<span class="sd">        │ orange ┆ M    ┆ 2012 │</span>
<span class="sd">        │ orange ┆ S    ┆ 2010 │</span>
<span class="sd">        │ orange ┆ S    ┆ 2011 │</span>
<span class="sd">        │ orange ┆ S    ┆ 2012 │</span>
<span class="sd">        │ orange ┆ XS   ┆ 2010 │</span>
<span class="sd">        │ orange ┆ XS   ┆ 2011 │</span>
<span class="sd">        │ orange ┆ XS   ┆ 2012 │</span>
<span class="sd">        └────────┴──────┴──────┘</span>

<span class="sd">        Get observations that only occur in the data:</span>
<span class="sd">        &gt;&gt;&gt; df.expand(pl.struct(&#39;type&#39;,&#39;size&#39;),sort=True).unnest(&#39;type&#39;)</span>
<span class="sd">        shape: (4, 2)</span>
<span class="sd">        ┌────────┬──────┐</span>
<span class="sd">        │ type   ┆ size │</span>
<span class="sd">        │ ---    ┆ ---  │</span>
<span class="sd">        │ str    ┆ str  │</span>
<span class="sd">        ╞════════╪══════╡</span>
<span class="sd">        │ apple  ┆ M    │</span>
<span class="sd">        │ apple  ┆ XS   │</span>
<span class="sd">        │ orange ┆ M    │</span>
<span class="sd">        │ orange ┆ S    │</span>
<span class="sd">        └────────┴──────┘</span>
<span class="sd">        &gt;&gt;&gt; df.expand(pl.struct(&#39;type&#39;,&#39;size&#39;,&#39;year&#39;),sort=True).unnest(&#39;type&#39;)</span>
<span class="sd">        shape: (5, 3)</span>
<span class="sd">        ┌────────┬──────┬──────┐</span>
<span class="sd">        │ type   ┆ size ┆ year │</span>
<span class="sd">        │ ---    ┆ ---  ┆ ---  │</span>
<span class="sd">        │ str    ┆ str  ┆ i64  │</span>
<span class="sd">        ╞════════╪══════╪══════╡</span>
<span class="sd">        │ apple  ┆ M    ┆ 2012 │</span>
<span class="sd">        │ apple  ┆ XS   ┆ 2010 │</span>
<span class="sd">        │ orange ┆ M    ┆ 2012 │</span>
<span class="sd">        │ orange ┆ S    ┆ 2010 │</span>
<span class="sd">        │ orange ┆ S    ┆ 2011 │</span>
<span class="sd">        └────────┴──────┴──────┘</span>

<span class="sd">        Expand the DataFrame to include new observations:</span>
<span class="sd">        &gt;&gt;&gt; with pl.Config(tbl_rows=-1):</span>
<span class="sd">        ...     df.expand(&#39;type&#39;,&#39;size&#39;,pl.int_range(2010,2014).alias(&#39;new_year&#39;),sort=True)</span>
<span class="sd">        shape: (24, 3)</span>
<span class="sd">        ┌────────┬──────┬──────────┐</span>
<span class="sd">        │ type   ┆ size ┆ new_year │</span>
<span class="sd">        │ ---    ┆ ---  ┆ ---      │</span>
<span class="sd">        │ str    ┆ str  ┆ i64      │</span>
<span class="sd">        ╞════════╪══════╪══════════╡</span>
<span class="sd">        │ apple  ┆ M    ┆ 2010     │</span>
<span class="sd">        │ apple  ┆ M    ┆ 2011     │</span>
<span class="sd">        │ apple  ┆ M    ┆ 2012     │</span>
<span class="sd">        │ apple  ┆ M    ┆ 2013     │</span>
<span class="sd">        │ apple  ┆ S    ┆ 2010     │</span>
<span class="sd">        │ apple  ┆ S    ┆ 2011     │</span>
<span class="sd">        │ apple  ┆ S    ┆ 2012     │</span>
<span class="sd">        │ apple  ┆ S    ┆ 2013     │</span>
<span class="sd">        │ apple  ┆ XS   ┆ 2010     │</span>
<span class="sd">        │ apple  ┆ XS   ┆ 2011     │</span>
<span class="sd">        │ apple  ┆ XS   ┆ 2012     │</span>
<span class="sd">        │ apple  ┆ XS   ┆ 2013     │</span>
<span class="sd">        │ orange ┆ M    ┆ 2010     │</span>
<span class="sd">        │ orange ┆ M    ┆ 2011     │</span>
<span class="sd">        │ orange ┆ M    ┆ 2012     │</span>
<span class="sd">        │ orange ┆ M    ┆ 2013     │</span>
<span class="sd">        │ orange ┆ S    ┆ 2010     │</span>
<span class="sd">        │ orange ┆ S    ┆ 2011     │</span>
<span class="sd">        │ orange ┆ S    ┆ 2012     │</span>
<span class="sd">        │ orange ┆ S    ┆ 2013     │</span>
<span class="sd">        │ orange ┆ XS   ┆ 2010     │</span>
<span class="sd">        │ orange ┆ XS   ┆ 2011     │</span>
<span class="sd">        │ orange ┆ XS   ┆ 2012     │</span>
<span class="sd">        │ orange ┆ XS   ┆ 2013     │</span>
<span class="sd">        └────────┴──────┴──────────┘</span>

<span class="sd">        Filter for missing observations:</span>
<span class="sd">        &gt;&gt;&gt; columns = (&#39;type&#39;,&#39;size&#39;,&#39;year&#39;)</span>
<span class="sd">        &gt;&gt;&gt; with pl.Config(tbl_rows=-1):</span>
<span class="sd">        ...     df.expand(*columns).join(df, how=&#39;anti&#39;, on=columns).sort(by=pl.all())</span>
<span class="sd">        shape: (13, 3)</span>
<span class="sd">        ┌────────┬──────┬──────┐</span>
<span class="sd">        │ type   ┆ size ┆ year │</span>
<span class="sd">        │ ---    ┆ ---  ┆ ---  │</span>
<span class="sd">        │ str    ┆ str  ┆ i64  │</span>
<span class="sd">        ╞════════╪══════╪══════╡</span>
<span class="sd">        │ apple  ┆ M    ┆ 2010 │</span>
<span class="sd">        │ apple  ┆ M    ┆ 2011 │</span>
<span class="sd">        │ apple  ┆ S    ┆ 2010 │</span>
<span class="sd">        │ apple  ┆ S    ┆ 2011 │</span>
<span class="sd">        │ apple  ┆ S    ┆ 2012 │</span>
<span class="sd">        │ apple  ┆ XS   ┆ 2011 │</span>
<span class="sd">        │ apple  ┆ XS   ┆ 2012 │</span>
<span class="sd">        │ orange ┆ M    ┆ 2010 │</span>
<span class="sd">        │ orange ┆ M    ┆ 2011 │</span>
<span class="sd">        │ orange ┆ S    ┆ 2012 │</span>
<span class="sd">        │ orange ┆ XS   ┆ 2010 │</span>
<span class="sd">        │ orange ┆ XS   ┆ 2011 │</span>
<span class="sd">        │ orange ┆ XS   ┆ 2012 │</span>
<span class="sd">        └────────┴──────┴──────┘</span>

<span class="sd">        Expand within each group, using `by`:</span>
<span class="sd">        &gt;&gt;&gt; with pl.Config(tbl_rows=-1):</span>
<span class="sd">        ...     df.expand(&#39;year&#39;,&#39;size&#39;,by=&#39;type&#39;,sort=True)</span>
<span class="sd">        shape: (10, 3)</span>
<span class="sd">        ┌────────┬──────┬──────┐</span>
<span class="sd">        │ type   ┆ year ┆ size │</span>
<span class="sd">        │ ---    ┆ ---  ┆ ---  │</span>
<span class="sd">        │ str    ┆ i64  ┆ str  │</span>
<span class="sd">        ╞════════╪══════╪══════╡</span>
<span class="sd">        │ apple  ┆ 2010 ┆ M    │</span>
<span class="sd">        │ apple  ┆ 2010 ┆ XS   │</span>
<span class="sd">        │ apple  ┆ 2012 ┆ M    │</span>
<span class="sd">        │ apple  ┆ 2012 ┆ XS   │</span>
<span class="sd">        │ orange ┆ 2010 ┆ M    │</span>
<span class="sd">        │ orange ┆ 2010 ┆ S    │</span>
<span class="sd">        │ orange ┆ 2011 ┆ M    │</span>
<span class="sd">        │ orange ┆ 2011 ┆ S    │</span>
<span class="sd">        │ orange ┆ 2012 ┆ M    │</span>
<span class="sd">        │ orange ┆ 2012 ┆ S    │</span>
<span class="sd">        └────────┴──────┴──────┘</span>

<span class="sd">    !!! info &quot;New in version 0.28.0&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        *columns: This refers to the columns to be completed.</span>
<span class="sd">            It can be a string or a column selector or a polars expression.</span>
<span class="sd">            A polars expression can be used to introduced new values,</span>
<span class="sd">            as long as the polars expression has a name that already exists</span>
<span class="sd">            in the DataFrame.</span>
<span class="sd">        sort: Sort the DataFrame based on *columns.</span>
<span class="sd">        by: Column(s) to group by.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A polars DataFrame/LazyFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">columns</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span>
    <span class="n">uniques</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_expand</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="n">by</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">uniques</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="janitor.polars.pivot_longer" class="doc doc-heading">
            <code>pivot_longer</code>


</h2>

    <div class="doc doc-contents ">

        <p>pivot_longer implementation for polars.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="janitor.polars.pivot_longer.pivot_longer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pivot_longer</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">column_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names_to</span><span class="o">=</span><span class="s1">&#39;variable&#39;</span><span class="p">,</span> <span class="n">values_to</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">names_sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names_pattern</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Unpivots a DataFrame from <em>wide</em> to <em>long</em> format.</p>
<p>It is modeled after the <code>pivot_longer</code> function in R's tidyr package,
and also takes inspiration from the <code>melt</code> function in R's data.table package.</p>
<p>This function is useful to massage a DataFrame into a format where
one or more columns are considered measured variables, and all other
columns are considered as identifier variables.</p>
<p>All measured variables are <em>unpivoted</em> (and typically duplicated) along the
row axis.</p>
<p>If <code>names_pattern</code>, use a valid regular expression pattern containing at least
one capture group, compatible with the <a href="https://docs.rs/regex/latest/regex/">regex crate</a>.</p>
<p>For more granular control on the unpivoting, have a look at
<a class="autorefs autorefs-internal" href="#janitor.polars.pivot_longer.pivot_longer_spec"><code>pivot_longer_spec</code></a>.</p>
<p><code>pivot_longer</code> can also be applied to a LazyFrame.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">polars.selectors</span> <span class="k">as</span> <span class="nn">cs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">janitor.polars</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;Sepal.Length&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.1</span><span class="p">,</span> <span class="mf">5.9</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;Sepal.Width&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;Petal.Length&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;Petal.Width&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;Species&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;setosa&quot;</span><span class="p">,</span> <span class="s2">&quot;virginica&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (2, 5)</span>
<span class="go">┌──────────────┬─────────────┬──────────────┬─────────────┬───────────┐</span>
<span class="go">│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species   │</span>
<span class="go">│ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---       │</span>
<span class="go">│ f64          ┆ f64         ┆ f64          ┆ f64         ┆ str       │</span>
<span class="go">╞══════════════╪═════════════╪══════════════╪═════════════╪═══════════╡</span>
<span class="go">│ 5.1          ┆ 3.5         ┆ 1.4          ┆ 0.2         ┆ setosa    │</span>
<span class="go">│ 5.9          ┆ 3.0         ┆ 5.1          ┆ 1.8         ┆ virginica │</span>
<span class="go">└──────────────┴─────────────┴──────────────┴─────────────┴───────────┘</span>
</code></pre></div>
    <p>Replicate polars' <a href="https://docs.pola.rs/py-polars/html/reference/dataframe/api/polars.DataFrame.unpivot.html#polars-dataframe-melt">melt</a>:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="s1">&#39;Species&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
<span class="go">shape: (8, 3)</span>
<span class="go">┌───────────┬──────────────┬───────┐</span>
<span class="go">│ Species   ┆ variable     ┆ value │</span>
<span class="go">│ ---       ┆ ---          ┆ ---   │</span>
<span class="go">│ str       ┆ str          ┆ f64   │</span>
<span class="go">╞═══════════╪══════════════╪═══════╡</span>
<span class="go">│ setosa    ┆ Petal.Length ┆ 1.4   │</span>
<span class="go">│ setosa    ┆ Petal.Width  ┆ 0.2   │</span>
<span class="go">│ setosa    ┆ Sepal.Length ┆ 5.1   │</span>
<span class="go">│ setosa    ┆ Sepal.Width  ┆ 3.5   │</span>
<span class="go">│ virginica ┆ Petal.Length ┆ 5.1   │</span>
<span class="go">│ virginica ┆ Petal.Width  ┆ 1.8   │</span>
<span class="go">│ virginica ┆ Sepal.Length ┆ 5.9   │</span>
<span class="go">│ virginica ┆ Sepal.Width  ┆ 3.0   │</span>
<span class="go">└───────────┴──────────────┴───────┘</span>
</code></pre></div>
    <p>Split the column labels into individual columns:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">index</span> <span class="o">=</span> <span class="s1">&#39;Species&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">names_to</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;part&#39;</span><span class="p">,</span> <span class="s1">&#39;dimension&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">names_sep</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;Species&#39;</span><span class="p">,</span><span class="s1">&#39;part&#39;</span><span class="p">,</span><span class="s1">&#39;dimension&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
<span class="go">shape: (8, 4)</span>
<span class="go">┌───────────┬───────┬───────────┬───────┐</span>
<span class="go">│ Species   ┆ part  ┆ dimension ┆ value │</span>
<span class="go">│ ---       ┆ ---   ┆ ---       ┆ ---   │</span>
<span class="go">│ str       ┆ str   ┆ str       ┆ f64   │</span>
<span class="go">╞═══════════╪═══════╪═══════════╪═══════╡</span>
<span class="go">│ setosa    ┆ Petal ┆ Length    ┆ 1.4   │</span>
<span class="go">│ setosa    ┆ Petal ┆ Width     ┆ 0.2   │</span>
<span class="go">│ setosa    ┆ Sepal ┆ Length    ┆ 5.1   │</span>
<span class="go">│ setosa    ┆ Sepal ┆ Width     ┆ 3.5   │</span>
<span class="go">│ virginica ┆ Petal ┆ Length    ┆ 5.1   │</span>
<span class="go">│ virginica ┆ Petal ┆ Width     ┆ 1.8   │</span>
<span class="go">│ virginica ┆ Sepal ┆ Length    ┆ 5.9   │</span>
<span class="go">│ virginica ┆ Sepal ┆ Width     ┆ 3.0   │</span>
<span class="go">└───────────┴───────┴───────────┴───────┘</span>
</code></pre></div>
    <p>Retain parts of the column names as headers:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">index</span> <span class="o">=</span> <span class="s1">&#39;Species&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">names_to</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;part&#39;</span><span class="p">,</span> <span class="s1">&#39;.value&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">names_sep</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;Species&#39;</span><span class="p">,</span><span class="s1">&#39;part&#39;</span><span class="p">,</span><span class="s1">&#39;Length&#39;</span><span class="p">,</span><span class="s1">&#39;Width&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
<span class="go">shape: (4, 4)</span>
<span class="go">┌───────────┬───────┬────────┬───────┐</span>
<span class="go">│ Species   ┆ part  ┆ Length ┆ Width │</span>
<span class="go">│ ---       ┆ ---   ┆ ---    ┆ ---   │</span>
<span class="go">│ str       ┆ str   ┆ f64    ┆ f64   │</span>
<span class="go">╞═══════════╪═══════╪════════╪═══════╡</span>
<span class="go">│ setosa    ┆ Petal ┆ 1.4    ┆ 0.2   │</span>
<span class="go">│ setosa    ┆ Sepal ┆ 5.1    ┆ 3.5   │</span>
<span class="go">│ virginica ┆ Petal ┆ 5.1    ┆ 1.8   │</span>
<span class="go">│ virginica ┆ Sepal ┆ 5.9    ┆ 3.0   │</span>
<span class="go">└───────────┴───────┴────────┴───────┘</span>
</code></pre></div>
    <p>Split the column labels based on regex:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;new_sp_m5564&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;newrel_f65&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (1, 3)</span>
<span class="go">┌─────┬──────────────┬────────────┐</span>
<span class="go">│ id  ┆ new_sp_m5564 ┆ newrel_f65 │</span>
<span class="go">│ --- ┆ ---          ┆ ---        │</span>
<span class="go">│ i64 ┆ i64          ┆ i64        │</span>
<span class="go">╞═════╪══════════════╪════════════╡</span>
<span class="go">│ 1   ┆ 2            ┆ 3          │</span>
<span class="go">└─────┴──────────────┴────────────┘</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">index</span> <span class="o">=</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">names_to</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;diagnosis&#39;</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">names_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;new_?(.+)_(.)([0-9]+)&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;diagnosis&#39;</span><span class="p">,</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span><span class="s1">&#39;age&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
<span class="go">shape: (2, 5)</span>
<span class="go">┌─────┬───────────┬────────┬──────┬───────┐</span>
<span class="go">│ id  ┆ diagnosis ┆ gender ┆ age  ┆ value │</span>
<span class="go">│ --- ┆ ---       ┆ ---    ┆ ---  ┆ ---   │</span>
<span class="go">│ i64 ┆ str       ┆ str    ┆ str  ┆ i64   │</span>
<span class="go">╞═════╪═══════════╪════════╪══════╪═══════╡</span>
<span class="go">│ 1   ┆ rel       ┆ f      ┆ 65   ┆ 3     │</span>
<span class="go">│ 1   ┆ sp        ┆ m      ┆ 5564 ┆ 2     │</span>
<span class="go">└─────┴───────────┴────────┴──────┴───────┘</span>
</code></pre></div>
    <p>Convert the dtypes of specific columns with <code>names_transform</code>:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">index</span> <span class="o">=</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">names_pattern</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;new_?(.+)_(.)([0-9]+)&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">names_to</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;diagnosis&quot;</span><span class="p">,</span> <span class="s2">&quot;gender&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">names_transform</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int32</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;diagnosis&quot;</span><span class="p">,</span> <span class="s2">&quot;gender&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
<span class="go">shape: (2, 5)</span>
<span class="go">┌─────┬───────────┬────────┬──────┬───────┐</span>
<span class="go">│ id  ┆ diagnosis ┆ gender ┆ age  ┆ value │</span>
<span class="go">│ --- ┆ ---       ┆ ---    ┆ ---  ┆ ---   │</span>
<span class="go">│ i64 ┆ str       ┆ str    ┆ i32  ┆ i64   │</span>
<span class="go">╞═════╪═══════════╪════════╪══════╪═══════╡</span>
<span class="go">│ 1   ┆ rel       ┆ f      ┆ 65   ┆ 3     │</span>
<span class="go">│ 1   ┆ sp        ┆ m      ┆ 5564 ┆ 2     │</span>
<span class="go">└─────┴───────────┴────────┴──────┴───────┘</span>
</code></pre></div>
    <p>Use multiple <code>.value</code> to reshape the dataframe:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="p">{</span>
<span class="gp">... </span>            <span class="s2">&quot;x_1_mean&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;x_2_mean&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;y_1_mean&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;y_2_mean&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>        <span class="p">}</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (1, 5)</span>
<span class="go">┌──────────┬──────────┬──────────┬──────────┬──────┐</span>
<span class="go">│ x_1_mean ┆ x_2_mean ┆ y_1_mean ┆ y_2_mean ┆ unit │</span>
<span class="go">│ ---      ┆ ---      ┆ ---      ┆ ---      ┆ ---  │</span>
<span class="go">│ i64      ┆ i64      ┆ i64      ┆ i64      ┆ i64  │</span>
<span class="go">╞══════════╪══════════╪══════════╪══════════╪══════╡</span>
<span class="go">│ 10       ┆ 20       ┆ 30       ┆ 40       ┆ 50   │</span>
<span class="go">└──────────┴──────────┴──────────┴──────────┴──────┘</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="s2">&quot;unit&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">names_to</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;.value&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;.value&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">names_pattern</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;(x|y)_([0-9])(_mean)&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;x_mean&#39;</span><span class="p">,</span><span class="s1">&#39;y_mean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
<span class="go">shape: (2, 4)</span>
<span class="go">┌──────┬──────┬────────┬────────┐</span>
<span class="go">│ unit ┆ time ┆ x_mean ┆ y_mean │</span>
<span class="go">│ ---  ┆ ---  ┆ ---    ┆ ---    │</span>
<span class="go">│ i64  ┆ str  ┆ i64    ┆ i64    │</span>
<span class="go">╞══════╪══════╪════════╪════════╡</span>
<span class="go">│ 50   ┆ 1    ┆ 10     ┆ 30     │</span>
<span class="go">│ 50   ┆ 2    ┆ 20     ┆ 40     │</span>
<span class="go">└──────┴──────┴────────┴────────┘</span>
</code></pre></div>
        <div class="admonition info">
<p class="admonition-title">New in version 0.28.0</p>
</div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code>ColumnNameOrSelector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column(s) or selector(s) to use as identifier variables.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column_names</code>
            </td>
            <td>
                  <code>ColumnNameOrSelector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column(s) or selector(s) to unpivot.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>names_to</code>
            </td>
            <td>
                  <code>list | tuple | str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of new column as a string that will contain
what were previously the column names in <code>column_names</code>.
The default is <code>variable</code> if no value is provided. It can
also be a list/tuple of strings that will serve as new column
names, if <code>name_sep</code> or <code>names_pattern</code> is provided.
If <code>.value</code> is in <code>names_to</code>, new column names will be extracted
from part of the existing column names and overrides <code>values_to</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;variable&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>values_to</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of new column as a string that will contain what
were previously the values of the columns in <code>column_names</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;value&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>names_sep</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Determines how the column name is broken up, if
<code>names_to</code> contains multiple values. It takes the same
specification as polars' <code>str.split</code> method.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>names_pattern</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Determines how the column name is broken up.
It can be a regular expression containing matching groups.
It takes the same specification as
polars' <code>str.extract_groups</code> method.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>names_transform</code>
            </td>
            <td>
                  <code>Expr</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Use this option to change the types of columns that
have been transformed to rows.
This does not applies to the values' columns.
Accepts a polars expression or a list of polars expressions.
Applicable only if one of names_sep
or names_pattern is provided.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame | LazyFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A polars DataFrame/LazyFrame that has been unpivoted</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame | LazyFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>from wide to long format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>janitor/polars/pivot_longer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@register_lazyframe_method</span>
<span class="nd">@register_dataframe_method</span>
<span class="k">def</span> <span class="nf">pivot_longer</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="n">ColumnNameOrSelector</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">column_names</span><span class="p">:</span> <span class="n">ColumnNameOrSelector</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">names_to</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">tuple</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;variable&quot;</span><span class="p">,</span>
    <span class="n">values_to</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span>
    <span class="n">names_sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">names_pattern</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">names_transform</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Unpivots a DataFrame from *wide* to *long* format.</span>

<span class="sd">    It is modeled after the `pivot_longer` function in R&#39;s tidyr package,</span>
<span class="sd">    and also takes inspiration from the `melt` function in R&#39;s data.table package.</span>

<span class="sd">    This function is useful to massage a DataFrame into a format where</span>
<span class="sd">    one or more columns are considered measured variables, and all other</span>
<span class="sd">    columns are considered as identifier variables.</span>

<span class="sd">    All measured variables are *unpivoted* (and typically duplicated) along the</span>
<span class="sd">    row axis.</span>

<span class="sd">    If `names_pattern`, use a valid regular expression pattern containing at least</span>
<span class="sd">    one capture group, compatible with the [regex crate](https://docs.rs/regex/latest/regex/).</span>

<span class="sd">    For more granular control on the unpivoting, have a look at</span>
<span class="sd">    [`pivot_longer_spec`][janitor.polars.pivot_longer.pivot_longer_spec].</span>

<span class="sd">    `pivot_longer` can also be applied to a LazyFrame.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import polars as pl</span>
<span class="sd">        &gt;&gt;&gt; import polars.selectors as cs</span>
<span class="sd">        &gt;&gt;&gt; import janitor.polars</span>
<span class="sd">        &gt;&gt;&gt; df = pl.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...         &quot;Sepal.Length&quot;: [5.1, 5.9],</span>
<span class="sd">        ...         &quot;Sepal.Width&quot;: [3.5, 3.0],</span>
<span class="sd">        ...         &quot;Petal.Length&quot;: [1.4, 5.1],</span>
<span class="sd">        ...         &quot;Petal.Width&quot;: [0.2, 1.8],</span>
<span class="sd">        ...         &quot;Species&quot;: [&quot;setosa&quot;, &quot;virginica&quot;],</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">        shape: (2, 5)</span>
<span class="sd">        ┌──────────────┬─────────────┬──────────────┬─────────────┬───────────┐</span>
<span class="sd">        │ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species   │</span>
<span class="sd">        │ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---       │</span>
<span class="sd">        │ f64          ┆ f64         ┆ f64          ┆ f64         ┆ str       │</span>
<span class="sd">        ╞══════════════╪═════════════╪══════════════╪═════════════╪═══════════╡</span>
<span class="sd">        │ 5.1          ┆ 3.5         ┆ 1.4          ┆ 0.2         ┆ setosa    │</span>
<span class="sd">        │ 5.9          ┆ 3.0         ┆ 5.1          ┆ 1.8         ┆ virginica │</span>
<span class="sd">        └──────────────┴─────────────┴──────────────┴─────────────┴───────────┘</span>

<span class="sd">        Replicate polars&#39; [melt](https://docs.pola.rs/py-polars/html/reference/dataframe/api/polars.DataFrame.unpivot.html#polars-dataframe-melt):</span>
<span class="sd">        &gt;&gt;&gt; df.pivot_longer(index = &#39;Species&#39;).sort(by=pl.all())</span>
<span class="sd">        shape: (8, 3)</span>
<span class="sd">        ┌───────────┬──────────────┬───────┐</span>
<span class="sd">        │ Species   ┆ variable     ┆ value │</span>
<span class="sd">        │ ---       ┆ ---          ┆ ---   │</span>
<span class="sd">        │ str       ┆ str          ┆ f64   │</span>
<span class="sd">        ╞═══════════╪══════════════╪═══════╡</span>
<span class="sd">        │ setosa    ┆ Petal.Length ┆ 1.4   │</span>
<span class="sd">        │ setosa    ┆ Petal.Width  ┆ 0.2   │</span>
<span class="sd">        │ setosa    ┆ Sepal.Length ┆ 5.1   │</span>
<span class="sd">        │ setosa    ┆ Sepal.Width  ┆ 3.5   │</span>
<span class="sd">        │ virginica ┆ Petal.Length ┆ 5.1   │</span>
<span class="sd">        │ virginica ┆ Petal.Width  ┆ 1.8   │</span>
<span class="sd">        │ virginica ┆ Sepal.Length ┆ 5.9   │</span>
<span class="sd">        │ virginica ┆ Sepal.Width  ┆ 3.0   │</span>
<span class="sd">        └───────────┴──────────────┴───────┘</span>

<span class="sd">        Split the column labels into individual columns:</span>
<span class="sd">        &gt;&gt;&gt; df.pivot_longer(</span>
<span class="sd">        ...     index = &#39;Species&#39;,</span>
<span class="sd">        ...     names_to = (&#39;part&#39;, &#39;dimension&#39;),</span>
<span class="sd">        ...     names_sep = &#39;.&#39;,</span>
<span class="sd">        ... ).select(&#39;Species&#39;,&#39;part&#39;,&#39;dimension&#39;,&#39;value&#39;).sort(by=pl.all())</span>
<span class="sd">        shape: (8, 4)</span>
<span class="sd">        ┌───────────┬───────┬───────────┬───────┐</span>
<span class="sd">        │ Species   ┆ part  ┆ dimension ┆ value │</span>
<span class="sd">        │ ---       ┆ ---   ┆ ---       ┆ ---   │</span>
<span class="sd">        │ str       ┆ str   ┆ str       ┆ f64   │</span>
<span class="sd">        ╞═══════════╪═══════╪═══════════╪═══════╡</span>
<span class="sd">        │ setosa    ┆ Petal ┆ Length    ┆ 1.4   │</span>
<span class="sd">        │ setosa    ┆ Petal ┆ Width     ┆ 0.2   │</span>
<span class="sd">        │ setosa    ┆ Sepal ┆ Length    ┆ 5.1   │</span>
<span class="sd">        │ setosa    ┆ Sepal ┆ Width     ┆ 3.5   │</span>
<span class="sd">        │ virginica ┆ Petal ┆ Length    ┆ 5.1   │</span>
<span class="sd">        │ virginica ┆ Petal ┆ Width     ┆ 1.8   │</span>
<span class="sd">        │ virginica ┆ Sepal ┆ Length    ┆ 5.9   │</span>
<span class="sd">        │ virginica ┆ Sepal ┆ Width     ┆ 3.0   │</span>
<span class="sd">        └───────────┴───────┴───────────┴───────┘</span>

<span class="sd">        Retain parts of the column names as headers:</span>
<span class="sd">        &gt;&gt;&gt; df.pivot_longer(</span>
<span class="sd">        ...     index = &#39;Species&#39;,</span>
<span class="sd">        ...     names_to = (&#39;part&#39;, &#39;.value&#39;),</span>
<span class="sd">        ...     names_sep = &#39;.&#39;,</span>
<span class="sd">        ... ).select(&#39;Species&#39;,&#39;part&#39;,&#39;Length&#39;,&#39;Width&#39;).sort(by=pl.all())</span>
<span class="sd">        shape: (4, 4)</span>
<span class="sd">        ┌───────────┬───────┬────────┬───────┐</span>
<span class="sd">        │ Species   ┆ part  ┆ Length ┆ Width │</span>
<span class="sd">        │ ---       ┆ ---   ┆ ---    ┆ ---   │</span>
<span class="sd">        │ str       ┆ str   ┆ f64    ┆ f64   │</span>
<span class="sd">        ╞═══════════╪═══════╪════════╪═══════╡</span>
<span class="sd">        │ setosa    ┆ Petal ┆ 1.4    ┆ 0.2   │</span>
<span class="sd">        │ setosa    ┆ Sepal ┆ 5.1    ┆ 3.5   │</span>
<span class="sd">        │ virginica ┆ Petal ┆ 5.1    ┆ 1.8   │</span>
<span class="sd">        │ virginica ┆ Sepal ┆ 5.9    ┆ 3.0   │</span>
<span class="sd">        └───────────┴───────┴────────┴───────┘</span>

<span class="sd">        Split the column labels based on regex:</span>
<span class="sd">        &gt;&gt;&gt; df = pl.DataFrame({&quot;id&quot;: [1], &quot;new_sp_m5564&quot;: [2], &quot;newrel_f65&quot;: [3]})</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">        shape: (1, 3)</span>
<span class="sd">        ┌─────┬──────────────┬────────────┐</span>
<span class="sd">        │ id  ┆ new_sp_m5564 ┆ newrel_f65 │</span>
<span class="sd">        │ --- ┆ ---          ┆ ---        │</span>
<span class="sd">        │ i64 ┆ i64          ┆ i64        │</span>
<span class="sd">        ╞═════╪══════════════╪════════════╡</span>
<span class="sd">        │ 1   ┆ 2            ┆ 3          │</span>
<span class="sd">        └─────┴──────────────┴────────────┘</span>
<span class="sd">        &gt;&gt;&gt; df.pivot_longer(</span>
<span class="sd">        ...     index = &#39;id&#39;,</span>
<span class="sd">        ...     names_to = (&#39;diagnosis&#39;, &#39;gender&#39;, &#39;age&#39;),</span>
<span class="sd">        ...     names_pattern = r&quot;new_?(.+)_(.)([0-9]+)&quot;,</span>
<span class="sd">        ... ).select(&#39;id&#39;,&#39;diagnosis&#39;,&#39;gender&#39;,&#39;age&#39;,&#39;value&#39;).sort(by=pl.all())</span>
<span class="sd">        shape: (2, 5)</span>
<span class="sd">        ┌─────┬───────────┬────────┬──────┬───────┐</span>
<span class="sd">        │ id  ┆ diagnosis ┆ gender ┆ age  ┆ value │</span>
<span class="sd">        │ --- ┆ ---       ┆ ---    ┆ ---  ┆ ---   │</span>
<span class="sd">        │ i64 ┆ str       ┆ str    ┆ str  ┆ i64   │</span>
<span class="sd">        ╞═════╪═══════════╪════════╪══════╪═══════╡</span>
<span class="sd">        │ 1   ┆ rel       ┆ f      ┆ 65   ┆ 3     │</span>
<span class="sd">        │ 1   ┆ sp        ┆ m      ┆ 5564 ┆ 2     │</span>
<span class="sd">        └─────┴───────────┴────────┴──────┴───────┘</span>

<span class="sd">        Convert the dtypes of specific columns with `names_transform`:</span>
<span class="sd">        &gt;&gt;&gt; df.pivot_longer(</span>
<span class="sd">        ...     index = &quot;id&quot;,</span>
<span class="sd">        ...     names_pattern=r&quot;new_?(.+)_(.)([0-9]+)&quot;,</span>
<span class="sd">        ...     names_to=(&quot;diagnosis&quot;, &quot;gender&quot;, &quot;age&quot;),</span>
<span class="sd">        ...     names_transform=pl.col(&#39;age&#39;).cast(pl.Int32),</span>
<span class="sd">        ... ).select(&quot;id&quot;, &quot;diagnosis&quot;, &quot;gender&quot;, &quot;age&quot;, &quot;value&quot;).sort(by=pl.all())</span>
<span class="sd">        shape: (2, 5)</span>
<span class="sd">        ┌─────┬───────────┬────────┬──────┬───────┐</span>
<span class="sd">        │ id  ┆ diagnosis ┆ gender ┆ age  ┆ value │</span>
<span class="sd">        │ --- ┆ ---       ┆ ---    ┆ ---  ┆ ---   │</span>
<span class="sd">        │ i64 ┆ str       ┆ str    ┆ i32  ┆ i64   │</span>
<span class="sd">        ╞═════╪═══════════╪════════╪══════╪═══════╡</span>
<span class="sd">        │ 1   ┆ rel       ┆ f      ┆ 65   ┆ 3     │</span>
<span class="sd">        │ 1   ┆ sp        ┆ m      ┆ 5564 ┆ 2     │</span>
<span class="sd">        └─────┴───────────┴────────┴──────┴───────┘</span>

<span class="sd">        Use multiple `.value` to reshape the dataframe:</span>
<span class="sd">        &gt;&gt;&gt; df = pl.DataFrame(</span>
<span class="sd">        ...     [</span>
<span class="sd">        ...         {</span>
<span class="sd">        ...             &quot;x_1_mean&quot;: 10,</span>
<span class="sd">        ...             &quot;x_2_mean&quot;: 20,</span>
<span class="sd">        ...             &quot;y_1_mean&quot;: 30,</span>
<span class="sd">        ...             &quot;y_2_mean&quot;: 40,</span>
<span class="sd">        ...             &quot;unit&quot;: 50,</span>
<span class="sd">        ...         }</span>
<span class="sd">        ...     ]</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">        shape: (1, 5)</span>
<span class="sd">        ┌──────────┬──────────┬──────────┬──────────┬──────┐</span>
<span class="sd">        │ x_1_mean ┆ x_2_mean ┆ y_1_mean ┆ y_2_mean ┆ unit │</span>
<span class="sd">        │ ---      ┆ ---      ┆ ---      ┆ ---      ┆ ---  │</span>
<span class="sd">        │ i64      ┆ i64      ┆ i64      ┆ i64      ┆ i64  │</span>
<span class="sd">        ╞══════════╪══════════╪══════════╪══════════╪══════╡</span>
<span class="sd">        │ 10       ┆ 20       ┆ 30       ┆ 40       ┆ 50   │</span>
<span class="sd">        └──────────┴──────────┴──────────┴──────────┴──────┘</span>
<span class="sd">        &gt;&gt;&gt; df.pivot_longer(</span>
<span class="sd">        ...     index=&quot;unit&quot;,</span>
<span class="sd">        ...     names_to=(&quot;.value&quot;, &quot;time&quot;, &quot;.value&quot;),</span>
<span class="sd">        ...     names_pattern=r&quot;(x|y)_([0-9])(_mean)&quot;,</span>
<span class="sd">        ... ).select(&#39;unit&#39;,&#39;time&#39;,&#39;x_mean&#39;,&#39;y_mean&#39;).sort(by=pl.all())</span>
<span class="sd">        shape: (2, 4)</span>
<span class="sd">        ┌──────┬──────┬────────┬────────┐</span>
<span class="sd">        │ unit ┆ time ┆ x_mean ┆ y_mean │</span>
<span class="sd">        │ ---  ┆ ---  ┆ ---    ┆ ---    │</span>
<span class="sd">        │ i64  ┆ str  ┆ i64    ┆ i64    │</span>
<span class="sd">        ╞══════╪══════╪════════╪════════╡</span>
<span class="sd">        │ 50   ┆ 1    ┆ 10     ┆ 30     │</span>
<span class="sd">        │ 50   ┆ 2    ┆ 20     ┆ 40     │</span>
<span class="sd">        └──────┴──────┴────────┴────────┘</span>

<span class="sd">    !!! info &quot;New in version 0.28.0&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        index: Column(s) or selector(s) to use as identifier variables.</span>
<span class="sd">        column_names: Column(s) or selector(s) to unpivot.</span>
<span class="sd">        names_to: Name of new column as a string that will contain</span>
<span class="sd">            what were previously the column names in `column_names`.</span>
<span class="sd">            The default is `variable` if no value is provided. It can</span>
<span class="sd">            also be a list/tuple of strings that will serve as new column</span>
<span class="sd">            names, if `name_sep` or `names_pattern` is provided.</span>
<span class="sd">            If `.value` is in `names_to`, new column names will be extracted</span>
<span class="sd">            from part of the existing column names and overrides `values_to`.</span>
<span class="sd">        values_to: Name of new column as a string that will contain what</span>
<span class="sd">            were previously the values of the columns in `column_names`.</span>
<span class="sd">        names_sep: Determines how the column name is broken up, if</span>
<span class="sd">            `names_to` contains multiple values. It takes the same</span>
<span class="sd">            specification as polars&#39; `str.split` method.</span>
<span class="sd">        names_pattern: Determines how the column name is broken up.</span>
<span class="sd">            It can be a regular expression containing matching groups.</span>
<span class="sd">            It takes the same specification as</span>
<span class="sd">            polars&#39; `str.extract_groups` method.</span>
<span class="sd">        names_transform: Use this option to change the types of columns that</span>
<span class="sd">            have been transformed to rows.</span>
<span class="sd">            This does not applies to the values&#39; columns.</span>
<span class="sd">            Accepts a polars expression or a list of polars expressions.</span>
<span class="sd">            Applicable only if one of names_sep</span>
<span class="sd">            or names_pattern is provided.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A polars DataFrame/LazyFrame that has been unpivoted</span>
<span class="sd">        from wide to long format.</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
    <span class="k">return</span> <span class="n">_pivot_longer</span><span class="p">(</span>
        <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
        <span class="n">column_names</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span>
        <span class="n">names_pattern</span><span class="o">=</span><span class="n">names_pattern</span><span class="p">,</span>
        <span class="n">names_sep</span><span class="o">=</span><span class="n">names_sep</span><span class="p">,</span>
        <span class="n">names_to</span><span class="o">=</span><span class="n">names_to</span><span class="p">,</span>
        <span class="n">values_to</span><span class="o">=</span><span class="n">values_to</span><span class="p">,</span>
        <span class="n">names_transform</span><span class="o">=</span><span class="n">names_transform</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="janitor.polars.pivot_longer.pivot_longer_spec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pivot_longer_spec</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>A declarative interface to pivot a Polars Frame
from wide to long form,
where you describe how the data will be unpivoted,
using a DataFrame.</p>
<p>It is modeled after tidyr's <code>pivot_longer_spec</code>.</p>
<p>This gives you, the user,
more control over the transformation to long form,
using a <em>spec</em> DataFrame that describes exactly
how data stored in the column names
becomes variables.</p>
<p>It can come in handy for situations where
<a class="autorefs autorefs-internal" href="#janitor.polars.pivot_longer.pivot_longer"><code>pivot_longer</code></a>
seems inadequate for the transformation.</p>
<div class="admonition info">
<p class="admonition-title">New in version 0.28.0</p>
</div>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">janitor.polars</span> <span class="kn">import</span> <span class="n">pivot_longer_spec</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;Sepal.Length&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.1</span><span class="p">,</span> <span class="mf">5.9</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;Sepal.Width&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;Petal.Length&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;Petal.Width&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;Species&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;setosa&quot;</span><span class="p">,</span> <span class="s2">&quot;virginica&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (2, 5)</span>
<span class="go">┌──────────────┬─────────────┬──────────────┬─────────────┬───────────┐</span>
<span class="go">│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species   │</span>
<span class="go">│ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---       │</span>
<span class="go">│ f64          ┆ f64         ┆ f64          ┆ f64         ┆ str       │</span>
<span class="go">╞══════════════╪═════════════╪══════════════╪═════════════╪═══════════╡</span>
<span class="go">│ 5.1          ┆ 3.5         ┆ 1.4          ┆ 0.2         ┆ setosa    │</span>
<span class="go">│ 5.9          ┆ 3.0         ┆ 5.1          ┆ 1.8         ┆ virginica │</span>
<span class="go">└──────────────┴─────────────┴──────────────┴─────────────┴───────────┘</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;.name&#39;</span><span class="p">:[</span><span class="s1">&#39;Sepal.Length&#39;</span><span class="p">,</span><span class="s1">&#39;Petal.Length&#39;</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="s1">&#39;Sepal.Width&#39;</span><span class="p">,</span><span class="s1">&#39;Petal.Width&#39;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s1">&#39;.value&#39;</span><span class="p">:[</span><span class="s1">&#39;Length&#39;</span><span class="p">,</span><span class="s1">&#39;Length&#39;</span><span class="p">,</span><span class="s1">&#39;Width&#39;</span><span class="p">,</span><span class="s1">&#39;Width&#39;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s1">&#39;part&#39;</span><span class="p">:[</span><span class="s1">&#39;Sepal&#39;</span><span class="p">,</span><span class="s1">&#39;Petal&#39;</span><span class="p">,</span><span class="s1">&#39;Sepal&#39;</span><span class="p">,</span><span class="s1">&#39;Petal&#39;</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span>
<span class="go">shape: (4, 3)</span>
<span class="go">┌──────────────┬────────┬───────┐</span>
<span class="go">│ .name        ┆ .value ┆ part  │</span>
<span class="go">│ ---          ┆ ---    ┆ ---   │</span>
<span class="go">│ str          ┆ str    ┆ str   │</span>
<span class="go">╞══════════════╪════════╪═══════╡</span>
<span class="go">│ Sepal.Length ┆ Length ┆ Sepal │</span>
<span class="go">│ Petal.Length ┆ Length ┆ Petal │</span>
<span class="go">│ Sepal.Width  ┆ Width  ┆ Sepal │</span>
<span class="go">│ Petal.Width  ┆ Width  ┆ Petal │</span>
<span class="go">└──────────────┴────────┴───────┘</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">pivot_longer_spec</span><span class="p">,</span><span class="n">spec</span><span class="o">=</span><span class="n">spec</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
<span class="go">shape: (4, 4)</span>
<span class="go">┌───────────┬───────┬────────┬───────┐</span>
<span class="go">│ Species   ┆ part  ┆ Length ┆ Width │</span>
<span class="go">│ ---       ┆ ---   ┆ ---    ┆ ---   │</span>
<span class="go">│ str       ┆ str   ┆ f64    ┆ f64   │</span>
<span class="go">╞═══════════╪═══════╪════════╪═══════╡</span>
<span class="go">│ setosa    ┆ Petal ┆ 1.4    ┆ 0.2   │</span>
<span class="go">│ setosa    ┆ Sepal ┆ 5.1    ┆ 3.5   │</span>
<span class="go">│ virginica ┆ Petal ┆ 5.1    ┆ 1.8   │</span>
<span class="go">│ virginica ┆ Sepal ┆ 5.9    ┆ 3.0   │</span>
<span class="go">└───────────┴───────┴────────┴───────┘</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code>DataFrame | LazyFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The source DataFrame to unpivot.
It can also be a LazyFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>spec</code>
            </td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A specification DataFrame.
At a minimum, the spec DataFrame
must have a <code>.name</code> column
and a <code>.value</code> column.
The <code>.name</code> column  should contain the
columns in the source DataFrame that will be
transformed to long form.
The <code>.value</code> column gives the name of the column
that the values in the source DataFrame will go into.
Additional columns in the spec DataFrame
should be named to match columns
in the long format of the dataset and contain values
corresponding to columns pivoted from the wide format.
Note that these additional columns should not already exist
in the source DataFrame.
If there are additional columns, the combination of these columns
and the <code>.value</code> column must be unique.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>.name</code> or <code>.value</code> is missing from the spec's columns.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the labels in spec's <code>.name</code> column is not unique.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame | LazyFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A polars DataFrame/LazyFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>janitor/polars/pivot_longer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">pivot_longer_spec</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">,</span>
    <span class="n">spec</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A declarative interface to pivot a Polars Frame</span>
<span class="sd">    from wide to long form,</span>
<span class="sd">    where you describe how the data will be unpivoted,</span>
<span class="sd">    using a DataFrame.</span>

<span class="sd">    It is modeled after tidyr&#39;s `pivot_longer_spec`.</span>

<span class="sd">    This gives you, the user,</span>
<span class="sd">    more control over the transformation to long form,</span>
<span class="sd">    using a *spec* DataFrame that describes exactly</span>
<span class="sd">    how data stored in the column names</span>
<span class="sd">    becomes variables.</span>

<span class="sd">    It can come in handy for situations where</span>
<span class="sd">    [`pivot_longer`][janitor.polars.pivot_longer.pivot_longer]</span>
<span class="sd">    seems inadequate for the transformation.</span>

<span class="sd">    !!! info &quot;New in version 0.28.0&quot;</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; from janitor.polars import pivot_longer_spec</span>
<span class="sd">        &gt;&gt;&gt; df = pl.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...         &quot;Sepal.Length&quot;: [5.1, 5.9],</span>
<span class="sd">        ...         &quot;Sepal.Width&quot;: [3.5, 3.0],</span>
<span class="sd">        ...         &quot;Petal.Length&quot;: [1.4, 5.1],</span>
<span class="sd">        ...         &quot;Petal.Width&quot;: [0.2, 1.8],</span>
<span class="sd">        ...         &quot;Species&quot;: [&quot;setosa&quot;, &quot;virginica&quot;],</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">        shape: (2, 5)</span>
<span class="sd">        ┌──────────────┬─────────────┬──────────────┬─────────────┬───────────┐</span>
<span class="sd">        │ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species   │</span>
<span class="sd">        │ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---       │</span>
<span class="sd">        │ f64          ┆ f64         ┆ f64          ┆ f64         ┆ str       │</span>
<span class="sd">        ╞══════════════╪═════════════╪══════════════╪═════════════╪═══════════╡</span>
<span class="sd">        │ 5.1          ┆ 3.5         ┆ 1.4          ┆ 0.2         ┆ setosa    │</span>
<span class="sd">        │ 5.9          ┆ 3.0         ┆ 5.1          ┆ 1.8         ┆ virginica │</span>
<span class="sd">        └──────────────┴─────────────┴──────────────┴─────────────┴───────────┘</span>
<span class="sd">        &gt;&gt;&gt; spec = {&#39;.name&#39;:[&#39;Sepal.Length&#39;,&#39;Petal.Length&#39;,</span>
<span class="sd">        ...                  &#39;Sepal.Width&#39;,&#39;Petal.Width&#39;],</span>
<span class="sd">        ...         &#39;.value&#39;:[&#39;Length&#39;,&#39;Length&#39;,&#39;Width&#39;,&#39;Width&#39;],</span>
<span class="sd">        ...         &#39;part&#39;:[&#39;Sepal&#39;,&#39;Petal&#39;,&#39;Sepal&#39;,&#39;Petal&#39;]}</span>
<span class="sd">        &gt;&gt;&gt; spec = pl.DataFrame(spec)</span>
<span class="sd">        &gt;&gt;&gt; spec</span>
<span class="sd">        shape: (4, 3)</span>
<span class="sd">        ┌──────────────┬────────┬───────┐</span>
<span class="sd">        │ .name        ┆ .value ┆ part  │</span>
<span class="sd">        │ ---          ┆ ---    ┆ ---   │</span>
<span class="sd">        │ str          ┆ str    ┆ str   │</span>
<span class="sd">        ╞══════════════╪════════╪═══════╡</span>
<span class="sd">        │ Sepal.Length ┆ Length ┆ Sepal │</span>
<span class="sd">        │ Petal.Length ┆ Length ┆ Petal │</span>
<span class="sd">        │ Sepal.Width  ┆ Width  ┆ Sepal │</span>
<span class="sd">        │ Petal.Width  ┆ Width  ┆ Petal │</span>
<span class="sd">        └──────────────┴────────┴───────┘</span>
<span class="sd">        &gt;&gt;&gt; df.pipe(pivot_longer_spec,spec=spec).sort(by=pl.all())</span>
<span class="sd">        shape: (4, 4)</span>
<span class="sd">        ┌───────────┬───────┬────────┬───────┐</span>
<span class="sd">        │ Species   ┆ part  ┆ Length ┆ Width │</span>
<span class="sd">        │ ---       ┆ ---   ┆ ---    ┆ ---   │</span>
<span class="sd">        │ str       ┆ str   ┆ f64    ┆ f64   │</span>
<span class="sd">        ╞═══════════╪═══════╪════════╪═══════╡</span>
<span class="sd">        │ setosa    ┆ Petal ┆ 1.4    ┆ 0.2   │</span>
<span class="sd">        │ setosa    ┆ Sepal ┆ 5.1    ┆ 3.5   │</span>
<span class="sd">        │ virginica ┆ Petal ┆ 5.1    ┆ 1.8   │</span>
<span class="sd">        │ virginica ┆ Sepal ┆ 5.9    ┆ 3.0   │</span>
<span class="sd">        └───────────┴───────┴────────┴───────┘</span>

<span class="sd">    Args:</span>
<span class="sd">        df: The source DataFrame to unpivot.</span>
<span class="sd">            It can also be a LazyFrame.</span>
<span class="sd">        spec: A specification DataFrame.</span>
<span class="sd">            At a minimum, the spec DataFrame</span>
<span class="sd">            must have a `.name` column</span>
<span class="sd">            and a `.value` column.</span>
<span class="sd">            The `.name` column  should contain the</span>
<span class="sd">            columns in the source DataFrame that will be</span>
<span class="sd">            transformed to long form.</span>
<span class="sd">            The `.value` column gives the name of the column</span>
<span class="sd">            that the values in the source DataFrame will go into.</span>
<span class="sd">            Additional columns in the spec DataFrame</span>
<span class="sd">            should be named to match columns</span>
<span class="sd">            in the long format of the dataset and contain values</span>
<span class="sd">            corresponding to columns pivoted from the wide format.</span>
<span class="sd">            Note that these additional columns should not already exist</span>
<span class="sd">            in the source DataFrame.</span>
<span class="sd">            If there are additional columns, the combination of these columns</span>
<span class="sd">            and the `.value` column must be unique.</span>

<span class="sd">    Raises:</span>
<span class="sd">        KeyError: If `.name` or `.value` is missing from the spec&#39;s columns.</span>
<span class="sd">        ValueError: If the labels in spec&#39;s `.name` column is not unique.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A polars DataFrame/LazyFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">check</span><span class="p">(</span><span class="s2">&quot;spec&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="p">[</span><span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">])</span>
    <span class="n">spec_columns</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">collect_schema</span><span class="p">()</span><span class="o">.</span><span class="n">names</span><span class="p">()</span>
    <span class="k">if</span> <span class="s2">&quot;.name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">spec_columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
            <span class="s2">&quot;Kindly ensure the spec DataFrame has a `.name` column.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;.value&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">spec_columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
            <span class="s2">&quot;Kindly ensure the spec DataFrame has a `.value` column.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">spec</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="s2">&quot;.name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The labels in the `.name` column should be unique.&quot;</span><span class="p">)</span>
    <span class="n">df_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">collect_schema</span><span class="p">()</span><span class="o">.</span><span class="n">names</span><span class="p">()</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df_columns</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">spec_columns</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Labels </span><span class="si">{</span><span class="o">*</span><span class="n">exclude</span><span class="p">,</span><span class="w"> </span><span class="si">}</span><span class="s2"> in the spec dataframe already exist &quot;</span>
            <span class="s2">&quot;as column labels in the source dataframe. &quot;</span>
            <span class="s2">&quot;Kindly ensure the spec DataFrame&#39;s columns &quot;</span>
            <span class="s2">&quot;are not present in the source DataFrame.&quot;</span>
        <span class="p">)</span>

    <span class="n">index</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">label</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">df_columns</span> <span class="k">if</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">spec</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="s2">&quot;.name&quot;</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">others</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">label</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">spec_columns</span> <span class="k">if</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;.name&quot;</span><span class="p">,</span> <span class="s2">&quot;.value&quot;</span><span class="p">}</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">others</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">others</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
            <span class="n">spec</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">others</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span>
        <span class="p">):</span>
            <span class="c1"># shortcut that avoids the implode/explode approach - and is faster</span>
            <span class="c1"># if the requirements are met</span>
            <span class="c1"># inspired by https://github.com/pola-rs/polars/pull/18519#issue-2500860927</span>
            <span class="k">return</span> <span class="n">_pivot_longer_dot_value_string</span><span class="p">(</span>
                <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
                <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
                <span class="n">spec</span><span class="o">=</span><span class="n">spec</span><span class="p">,</span>
                <span class="n">variable_name</span><span class="o">=</span><span class="n">others</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="n">variable_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_columns</span> <span class="o">+</span> <span class="n">spec_columns</span><span class="p">)</span>
        <span class="n">variable_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2">_&quot;</span>
        <span class="n">dot_value_only</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">expression</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">struct</span><span class="p">(</span><span class="n">others</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">variable_name</span><span class="p">)</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;.name&quot;</span><span class="p">,</span> <span class="s2">&quot;.value&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">variable_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_columns</span> <span class="o">+</span> <span class="n">spec_columns</span><span class="p">)</span>
        <span class="n">variable_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2">_&quot;</span>
        <span class="n">dot_value_only</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">expression</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">cum_count</span><span class="p">(</span><span class="s2">&quot;.value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="s2">&quot;.value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">variable_name</span><span class="p">)</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_pivot_longer_dot_value</span><span class="p">(</span>
        <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
        <span class="n">spec</span><span class="o">=</span><span class="n">spec</span><span class="p">,</span>
        <span class="n">variable_name</span><span class="o">=</span><span class="n">variable_name</span><span class="p">,</span>
        <span class="n">dot_value_only</span><span class="o">=</span><span class="n">dot_value_only</span><span class="p">,</span>
        <span class="n">names_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="janitor.polars.row_to_names" class="doc doc-heading">
            <code>row_to_names</code>


</h2>

    <div class="doc doc-contents ">

        <p>row_to_names implementation for polars.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="janitor.polars.row_to_names.row_to_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">row_to_names</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">row_numbers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">remove_rows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_rows_above</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Elevates a row, or rows, to be the column names of a DataFrame.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Replace column names with the first row.</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">janitor.polars</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;nums&quot;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;chars&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (3, 2)</span>
<span class="go">┌──────┬───────┐</span>
<span class="go">│ a    ┆ b     │</span>
<span class="go">│ ---  ┆ ---   │</span>
<span class="go">│ str  ┆ str   │</span>
<span class="go">╞══════╪═══════╡</span>
<span class="go">│ nums ┆ chars │</span>
<span class="go">│ 6    ┆ x     │</span>
<span class="go">│ 9    ┆ y     │</span>
<span class="go">└──────┴───────┘</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">row_to_names</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">remove_rows</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">shape: (2, 2)</span>
<span class="go">┌──────┬───────┐</span>
<span class="go">│ nums ┆ chars │</span>
<span class="go">│ ---  ┆ ---   │</span>
<span class="go">│ str  ┆ str   │</span>
<span class="go">╞══════╪═══════╡</span>
<span class="go">│ 6    ┆ x     │</span>
<span class="go">│ 9    ┆ y     │</span>
<span class="go">└──────┴───────┘</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">row_to_names</span><span class="p">(</span><span class="n">row_numbers</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">remove_rows</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">shape: (1, 2)</span>
<span class="go">┌────────┬─────────┐</span>
<span class="go">│ nums_6 ┆ chars_x │</span>
<span class="go">│ ---    ┆ ---     │</span>
<span class="go">│ str    ┆ str     │</span>
<span class="go">╞════════╪═════════╡</span>
<span class="go">│ 9      ┆ y       │</span>
<span class="go">└────────┴─────────┘</span>
</code></pre></div>
    <p>Remove rows above the elevated row and the elevated row itself.</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bla1&quot;</span><span class="p">,</span> <span class="s2">&quot;nums&quot;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bla2&quot;</span><span class="p">,</span> <span class="s2">&quot;chars&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (4, 2)</span>
<span class="go">┌──────┬───────┐</span>
<span class="go">│ a    ┆ b     │</span>
<span class="go">│ ---  ┆ ---   │</span>
<span class="go">│ str  ┆ str   │</span>
<span class="go">╞══════╪═══════╡</span>
<span class="go">│ bla1 ┆ bla2  │</span>
<span class="go">│ nums ┆ chars │</span>
<span class="go">│ 6    ┆ x     │</span>
<span class="go">│ 9    ┆ y     │</span>
<span class="go">└──────┴───────┘</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">row_to_names</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">remove_rows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_rows_above</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">shape: (2, 2)</span>
<span class="go">┌──────┬───────┐</span>
<span class="go">│ nums ┆ chars │</span>
<span class="go">│ ---  ┆ ---   │</span>
<span class="go">│ str  ┆ str   │</span>
<span class="go">╞══════╪═══════╡</span>
<span class="go">│ 6    ┆ x     │</span>
<span class="go">│ 9    ┆ y     │</span>
<span class="go">└──────┴───────┘</span>
</code></pre></div>
        <div class="admonition info">
<p class="admonition-title">New in version 0.28.0</p>
</div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>row_numbers</code>
            </td>
            <td>
                  <code>int | list | slice</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Position of the row(s) containing the variable names.
It can be an integer, list or a slice.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>remove_rows</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the row(s) should be removed from the DataFrame.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>remove_rows_above</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the row(s) above the selected row should
be removed from the DataFrame.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>separator</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Combines the labels into a single string,
if row_numbers is a list of integers. Default is '_'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;_&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A polars DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>janitor/polars/row_to_names.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@register_dataframe_method</span>
<span class="k">def</span> <span class="nf">row_to_names</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">row_numbers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">slice</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">remove_rows</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">remove_rows_above</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Elevates a row, or rows, to be the column names of a DataFrame.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Replace column names with the first row.</span>

<span class="sd">        &gt;&gt;&gt; import polars as pl</span>
<span class="sd">        &gt;&gt;&gt; import janitor.polars</span>
<span class="sd">        &gt;&gt;&gt; df = pl.DataFrame({</span>
<span class="sd">        ...     &quot;a&quot;: [&quot;nums&quot;, &#39;6&#39;, &#39;9&#39;],</span>
<span class="sd">        ...     &quot;b&quot;: [&quot;chars&quot;, &quot;x&quot;, &quot;y&quot;],</span>
<span class="sd">        ... })</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">        shape: (3, 2)</span>
<span class="sd">        ┌──────┬───────┐</span>
<span class="sd">        │ a    ┆ b     │</span>
<span class="sd">        │ ---  ┆ ---   │</span>
<span class="sd">        │ str  ┆ str   │</span>
<span class="sd">        ╞══════╪═══════╡</span>
<span class="sd">        │ nums ┆ chars │</span>
<span class="sd">        │ 6    ┆ x     │</span>
<span class="sd">        │ 9    ┆ y     │</span>
<span class="sd">        └──────┴───────┘</span>
<span class="sd">        &gt;&gt;&gt; df.row_to_names(0, remove_rows=True)</span>
<span class="sd">        shape: (2, 2)</span>
<span class="sd">        ┌──────┬───────┐</span>
<span class="sd">        │ nums ┆ chars │</span>
<span class="sd">        │ ---  ┆ ---   │</span>
<span class="sd">        │ str  ┆ str   │</span>
<span class="sd">        ╞══════╪═══════╡</span>
<span class="sd">        │ 6    ┆ x     │</span>
<span class="sd">        │ 9    ┆ y     │</span>
<span class="sd">        └──────┴───────┘</span>
<span class="sd">        &gt;&gt;&gt; df.row_to_names(row_numbers=[0,1], remove_rows=True)</span>
<span class="sd">        shape: (1, 2)</span>
<span class="sd">        ┌────────┬─────────┐</span>
<span class="sd">        │ nums_6 ┆ chars_x │</span>
<span class="sd">        │ ---    ┆ ---     │</span>
<span class="sd">        │ str    ┆ str     │</span>
<span class="sd">        ╞════════╪═════════╡</span>
<span class="sd">        │ 9      ┆ y       │</span>
<span class="sd">        └────────┴─────────┘</span>

<span class="sd">        Remove rows above the elevated row and the elevated row itself.</span>

<span class="sd">        &gt;&gt;&gt; df = pl.DataFrame({</span>
<span class="sd">        ...     &quot;a&quot;: [&quot;bla1&quot;, &quot;nums&quot;, &#39;6&#39;, &#39;9&#39;],</span>
<span class="sd">        ...     &quot;b&quot;: [&quot;bla2&quot;, &quot;chars&quot;, &quot;x&quot;, &quot;y&quot;],</span>
<span class="sd">        ... })</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">        shape: (4, 2)</span>
<span class="sd">        ┌──────┬───────┐</span>
<span class="sd">        │ a    ┆ b     │</span>
<span class="sd">        │ ---  ┆ ---   │</span>
<span class="sd">        │ str  ┆ str   │</span>
<span class="sd">        ╞══════╪═══════╡</span>
<span class="sd">        │ bla1 ┆ bla2  │</span>
<span class="sd">        │ nums ┆ chars │</span>
<span class="sd">        │ 6    ┆ x     │</span>
<span class="sd">        │ 9    ┆ y     │</span>
<span class="sd">        └──────┴───────┘</span>
<span class="sd">        &gt;&gt;&gt; df.row_to_names(1, remove_rows=True, remove_rows_above=True)</span>
<span class="sd">        shape: (2, 2)</span>
<span class="sd">        ┌──────┬───────┐</span>
<span class="sd">        │ nums ┆ chars │</span>
<span class="sd">        │ ---  ┆ ---   │</span>
<span class="sd">        │ str  ┆ str   │</span>
<span class="sd">        ╞══════╪═══════╡</span>
<span class="sd">        │ 6    ┆ x     │</span>
<span class="sd">        │ 9    ┆ y     │</span>
<span class="sd">        └──────┴───────┘</span>

<span class="sd">    !!! info &quot;New in version 0.28.0&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        row_numbers: Position of the row(s) containing the variable names.</span>
<span class="sd">            It can be an integer, list or a slice.</span>
<span class="sd">        remove_rows: Whether the row(s) should be removed from the DataFrame.</span>
<span class="sd">        remove_rows_above: Whether the row(s) above the selected row should</span>
<span class="sd">            be removed from the DataFrame.</span>
<span class="sd">        separator: Combines the labels into a single string,</span>
<span class="sd">            if row_numbers is a list of integers. Default is &#39;_&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A polars DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
    <span class="k">return</span> <span class="n">_row_to_names</span><span class="p">(</span>
        <span class="n">row_numbers</span><span class="p">,</span>
        <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
        <span class="n">remove_rows</span><span class="o">=</span><span class="n">remove_rows</span><span class="p">,</span>
        <span class="n">remove_rows_above</span><span class="o">=</span><span class="n">remove_rows_above</span><span class="p">,</span>
        <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.top", "toc.follow", "content.code.copy"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>