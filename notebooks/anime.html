
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Processing Anime Data &#8212; pyjanitor  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Replacing Bad Values" href="bad_values.html" />
    <link rel="prev" title="row_to_names : Elevates a row to be the column names of a DataFrame." href="Row_to_Names.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Processing-Anime-Data">
<h1>Processing Anime Data<a class="headerlink" href="#Processing-Anime-Data" title="Permalink to this headline">¶</a></h1>
<section id="Background">
<h2>Background<a class="headerlink" href="#Background" title="Permalink to this headline">¶</a></h2>
<p>We will use pyjanitor to showcase how to conveniently chain methods together to perform data cleaning in one shot. We We first define and register a series of dataframe methods with pandas_flavor. Then we chain the dataframe methods together with pyjanitor methods to complete the data cleaning process. The below example shows a one-shot script followed by a step-by-step detail of each part of the method chain.</p>
<p>We have adapted a <a class="reference external" href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2019/2019-04-23/readme.md">TidyTuesday analysis</a> that was originally performed in R. The original text from TidyTuesday will be shown in blockquotes.</p>
<p>Note: TidyTuesday is based on the principles discussed and made popular by Hadley Wickham in his paper <a class="reference external" href="https://www.jstatsoft.org/index.php/jss/article/view/v059i10/v59i10.pdf">Tidy Data</a>.</p>
<p><em>The original text from TidyTuesday will be shown in blockquotes.</em> Here is a description of the Anime data set that we will use.</p>
<blockquote>
<div><p>This week’s data comes from <a class="reference external" href="https://github.com/tamdrashtri">Tam Nguyen</a> and <a class="reference external" href="https://www.kaggle.com/aludosan/myanimelist-anime-dataset-as-20190204">MyAnimeList.net via Kaggle</a>. <a class="reference external" href="https://en.wikipedia.org/wiki/MyAnimeList">According to Wikipedia</a> - “MyAnimeList, often abbreviated as MAL, is an anime and manga social networking and social cataloging application website. The site provides its users with a list-like system to organize and score anime and manga. It facilitates finding
users who share similar tastes and provides a large database on anime and manga. The site claims to have 4.4 million anime and 775,000 manga entries. In 2015, the site received 120 million visitors a month.”</p>
<p>Anime without rankings or popularity scores were excluded. Producers, genre, and studio were converted from lists to tidy observations, so there will be repetitions of shows with multiple producers, genres, etc. The raw data is also uploaded.</p>
<p>Lots of interesting ways to explore the data this week!</p>
</div></blockquote>
<p>Import libraries and load data</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import pyjanitor and pandas</span>
<span class="kn">import</span> <span class="nn">janitor</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pandas_flavor</span> <span class="k">as</span> <span class="nn">pf</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Supress user warnings when we try overwriting our custom pandas flavor functions</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="One-Shot">
<h2>One-Shot<a class="headerlink" href="#One-Shot" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-04-23/raw_anime.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>


<span class="nd">@pf</span><span class="o">.</span><span class="n">register_dataframe_method</span>
<span class="k">def</span> <span class="nf">str_remove</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pat</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrapper around df.str.replace&quot;&quot;&quot;</span>

    <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>


<span class="nd">@pf</span><span class="o">.</span><span class="n">register_dataframe_method</span>
<span class="k">def</span> <span class="nf">str_trim</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrapper around df.str.strip&quot;&quot;&quot;</span>

    <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>


<span class="nd">@pf</span><span class="o">.</span><span class="n">register_dataframe_method</span>
<span class="k">def</span> <span class="nf">explode</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For rows with a list of values, this function will create new</span>
<span class="sd">    rows for each value in the list</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
    <span class="n">wdf</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="o">.</span><span class="n">stack</span><span class="p">()</span>
        <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="c1"># exploded_column = column_name</span>
    <span class="n">wdf</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]</span>  <span class="c1"># plural form to singular form</span>
    <span class="c1"># wdf[column_name] = wdf[column_name].apply(lambda x: x.strip())  # trim</span>
    <span class="n">wdf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">wdf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_drop&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">column_name</span> <span class="o">+</span> <span class="s2">&quot;_drop&quot;</span><span class="p">]</span>
    <span class="p">)</span>


<span class="nd">@pf</span><span class="o">.</span><span class="n">register_dataframe_method</span>
<span class="k">def</span> <span class="nf">str_word</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span>
    <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pat</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper around `df.str.split` with additional `start` and `end` arguments</span>
<span class="sd">    to select a slice of the list of words.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">pat</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span>


<span class="nd">@pf</span><span class="o">.</span><span class="n">register_dataframe_method</span>
<span class="k">def</span> <span class="nf">str_join</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper around `df.str.join`</span>
<span class="sd">    Joins items in a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>


<span class="nd">@pf</span><span class="o">.</span><span class="n">register_dataframe_method</span>
<span class="k">def</span> <span class="nf">str_slice</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper around `df.str.slice</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span>


<span class="n">clean_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;producers&quot;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s2">&quot;\[|\]&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;producers&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;producers&quot;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_trim</span><span class="p">(</span><span class="s2">&quot;producers&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;genre&quot;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s2">&quot;\[|\]&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;genre&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;genre&quot;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_trim</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;genre&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;studio&quot;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s2">&quot;\[|\]&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;studio&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;studio&quot;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_trim</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;studio&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;aired&quot;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s2">&quot;\{|\}|&#39;from&#39;:\s*|&#39;to&#39;:\s*&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_word</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;aired&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_join</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;aired&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">deconcatenate_column</span><span class="p">(</span>
        <span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;aired&quot;</span><span class="p">,</span> <span class="n">new_column_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;start_date&quot;</span><span class="p">,</span> <span class="s2">&quot;end_date&quot;</span><span class="p">],</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="n">column_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;aired&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;start_date&quot;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_slice</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;start_date&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;end_date&quot;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_slice</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;end_date&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;start_date&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;end_date&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">fill_empty</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rank&quot;</span><span class="p">,</span> <span class="s2">&quot;popularity&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="o">.</span><span class="n">filter_on</span><span class="p">(</span><span class="s2">&quot;rank != 0 &amp; popularity != 0&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clean_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>animeID</th>
      <th>name</th>
      <th>title_english</th>
      <th>title_japanese</th>
      <th>title_synonyms</th>
      <th>type</th>
      <th>source</th>
      <th>episodes</th>
      <th>status</th>
      <th>airing</th>
      <th>...</th>
      <th>synopsis</th>
      <th>background</th>
      <th>premiered</th>
      <th>broadcast</th>
      <th>related</th>
      <th>producers</th>
      <th>genre</th>
      <th>studio</th>
      <th>start_date</th>
      <th>end_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Cowboy Bebop</td>
      <td>Cowboy Bebop</td>
      <td>カウボーイビバップ</td>
      <td>[]</td>
      <td>TV</td>
      <td>Original</td>
      <td>26.0</td>
      <td>Finished Airing</td>
      <td>False</td>
      <td>...</td>
      <td>In the year 2071, humanity has colonized sever...</td>
      <td>When Cowboy Bebop first aired in spring of 199...</td>
      <td>Spring 1998</td>
      <td>Saturdays at 01:00 (JST)</td>
      <td>{'Adaptation': [{'mal_id': 173, 'type': 'manga...</td>
      <td>Bandai Visual</td>
      <td>Action</td>
      <td>Sunrise</td>
      <td>1998-04-03</td>
      <td>1999-04-24</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Cowboy Bebop</td>
      <td>Cowboy Bebop</td>
      <td>カウボーイビバップ</td>
      <td>[]</td>
      <td>TV</td>
      <td>Original</td>
      <td>26.0</td>
      <td>Finished Airing</td>
      <td>False</td>
      <td>...</td>
      <td>In the year 2071, humanity has colonized sever...</td>
      <td>When Cowboy Bebop first aired in spring of 199...</td>
      <td>Spring 1998</td>
      <td>Saturdays at 01:00 (JST)</td>
      <td>{'Adaptation': [{'mal_id': 173, 'type': 'manga...</td>
      <td>Bandai Visual</td>
      <td>Adventure</td>
      <td>Sunrise</td>
      <td>1998-04-03</td>
      <td>1999-04-24</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Cowboy Bebop</td>
      <td>Cowboy Bebop</td>
      <td>カウボーイビバップ</td>
      <td>[]</td>
      <td>TV</td>
      <td>Original</td>
      <td>26.0</td>
      <td>Finished Airing</td>
      <td>False</td>
      <td>...</td>
      <td>In the year 2071, humanity has colonized sever...</td>
      <td>When Cowboy Bebop first aired in spring of 199...</td>
      <td>Spring 1998</td>
      <td>Saturdays at 01:00 (JST)</td>
      <td>{'Adaptation': [{'mal_id': 173, 'type': 'manga...</td>
      <td>Bandai Visual</td>
      <td>Comedy</td>
      <td>Sunrise</td>
      <td>1998-04-03</td>
      <td>1999-04-24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Cowboy Bebop</td>
      <td>Cowboy Bebop</td>
      <td>カウボーイビバップ</td>
      <td>[]</td>
      <td>TV</td>
      <td>Original</td>
      <td>26.0</td>
      <td>Finished Airing</td>
      <td>False</td>
      <td>...</td>
      <td>In the year 2071, humanity has colonized sever...</td>
      <td>When Cowboy Bebop first aired in spring of 199...</td>
      <td>Spring 1998</td>
      <td>Saturdays at 01:00 (JST)</td>
      <td>{'Adaptation': [{'mal_id': 173, 'type': 'manga...</td>
      <td>Bandai Visual</td>
      <td>Drama</td>
      <td>Sunrise</td>
      <td>1998-04-03</td>
      <td>1999-04-24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Cowboy Bebop</td>
      <td>Cowboy Bebop</td>
      <td>カウボーイビバップ</td>
      <td>[]</td>
      <td>TV</td>
      <td>Original</td>
      <td>26.0</td>
      <td>Finished Airing</td>
      <td>False</td>
      <td>...</td>
      <td>In the year 2071, humanity has colonized sever...</td>
      <td>When Cowboy Bebop first aired in spring of 199...</td>
      <td>Spring 1998</td>
      <td>Saturdays at 01:00 (JST)</td>
      <td>{'Adaptation': [{'mal_id': 173, 'type': 'manga...</td>
      <td>Bandai Visual</td>
      <td>Sci-Fi</td>
      <td>Sunrise</td>
      <td>1998-04-03</td>
      <td>1999-04-24</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div></div>
</div>
</section>
<section id="Multi-Step">
<h2>Multi-Step<a class="headerlink" href="#Multi-Step" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Data Dictionary</p>
<p>Heads up the dataset is about 97 mb - if you want to free up some space, drop the synopsis and background, they are long strings, or broadcast, premiered, related as they are redundant or less useful.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 41%" />
<col style="width: 27%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>variable</p></th>
<th class="head"><p>class</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>animeID</p></td>
<td><p>double</p></td>
<td><p>Anime ID (as in <a class="reference external" href="https://myanimelist.net/anime/animeID">https://myanimelist.net/anime/animeID</a>)</p></td>
</tr>
<tr class="row-odd"><td><p>name</p></td>
<td><p>character</p></td>
<td><p>anime title - extracted from the site.</p></td>
</tr>
<tr class="row-even"><td><p>title_english</p></td>
<td><p>character</p></td>
<td><p>title in English (sometimes is different, sometimes is missing)</p></td>
</tr>
<tr class="row-odd"><td><p>title_japanese</p></td>
<td><p>character</p></td>
<td><p>title in Japanese (if Anime is Chinese or Korean, the title, if available, in the respective language)</p></td>
</tr>
<tr class="row-even"><td><p>title_synonyms</p></td>
<td><p>character</p></td>
<td><p>other variants of the title</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td><p>character</p></td>
<td><p>anime type (e.g. TV, Movie, OVA)</p></td>
</tr>
<tr class="row-even"><td><p>source</p></td>
<td><p>character</p></td>
<td><p>source of anime (i.e original, manga, game, music, visual novel etc.)</p></td>
</tr>
<tr class="row-odd"><td><p>producers</p></td>
<td><p>character</p></td>
<td><p>producers</p></td>
</tr>
<tr class="row-even"><td><p>genre</p></td>
<td><p>character</p></td>
<td><p>genre</p></td>
</tr>
<tr class="row-odd"><td><p>studio</p></td>
<td><p>character</p></td>
<td><p>studio</p></td>
</tr>
<tr class="row-even"><td><p>episodes</p></td>
<td><p>double</p></td>
<td><p>number of episodes</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>character</p></td>
<td><p>Aired or not aired</p></td>
</tr>
<tr class="row-even"><td><p>airing</p></td>
<td><p>logical</p></td>
<td><p>True/False is still airing</p></td>
</tr>
<tr class="row-odd"><td><p>start_date</p></td>
<td><p>double</p></td>
<td><p>Start date (ymd)</p></td>
</tr>
<tr class="row-even"><td><p>end_date</p></td>
<td><p>double</p></td>
<td><p>End date (ymd)</p></td>
</tr>
<tr class="row-odd"><td><p>duration</p></td>
<td><p>character</p></td>
<td><p>Per episode duration or entire duration, text string</p></td>
</tr>
<tr class="row-even"><td><p>rating</p></td>
<td><p>character</p></td>
<td><p>Age rating</p></td>
</tr>
<tr class="row-odd"><td><p>score</p></td>
<td><p>double</p></td>
<td><p>Score (higher = better)</p></td>
</tr>
<tr class="row-even"><td><p>scored_by</p></td>
<td><p>double</p></td>
<td><p>Number of users that scored</p></td>
</tr>
<tr class="row-odd"><td><p>rank</p></td>
<td><p>double</p></td>
<td><p>Rank - weight according to MyAnimeList formula</p></td>
</tr>
<tr class="row-even"><td><p>popularity</p></td>
<td><p>double</p></td>
<td><p>based on how many members/users have the respective anime in their list</p></td>
</tr>
<tr class="row-odd"><td><p>members</p></td>
<td><p>double</p></td>
<td><p>number members that added this anime in their list</p></td>
</tr>
<tr class="row-even"><td><p>favorites</p></td>
<td><p>double</p></td>
<td><p>number members that favorites these in their list</p></td>
</tr>
<tr class="row-odd"><td><p>synopsis</p></td>
<td><p>character</p></td>
<td><p>long string with anime synopsis</p></td>
</tr>
<tr class="row-even"><td><p>background</p></td>
<td><p>character</p></td>
<td><p>long string with production background and other things</p></td>
</tr>
<tr class="row-odd"><td><p>premiered</p></td>
<td><p>character</p></td>
<td><p>anime premiered on season/year</p></td>
</tr>
<tr class="row-even"><td><p>broadcast</p></td>
<td><p>character</p></td>
<td><p>when is (regularly) broadcasted</p></td>
</tr>
<tr class="row-odd"><td><p>related</p></td>
<td><p>character</p></td>
<td><p>dictionary: related animes, series, games etc.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<section id="Step-0:-Load-data">
<h3>Step 0: Load data<a class="headerlink" href="#Step-0:-Load-data" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-04-23/raw_anime.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>animeID</th>
      <td>1</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>name</th>
      <td>Cowboy Bebop</td>
      <td>Cowboy Bebop: Tengoku no Tobira</td>
      <td>Trigun</td>
    </tr>
    <tr>
      <th>title_english</th>
      <td>Cowboy Bebop</td>
      <td>Cowboy Bebop: The Movie</td>
      <td>Trigun</td>
    </tr>
    <tr>
      <th>title_japanese</th>
      <td>カウボーイビバップ</td>
      <td>カウボーイビバップ 天国の扉</td>
      <td>トライガン</td>
    </tr>
    <tr>
      <th>title_synonyms</th>
      <td>[]</td>
      <td>["Cowboy Bebop: Knockin' on Heaven's Door"]</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>type</th>
      <td>TV</td>
      <td>Movie</td>
      <td>TV</td>
    </tr>
    <tr>
      <th>source</th>
      <td>Original</td>
      <td>Original</td>
      <td>Manga</td>
    </tr>
    <tr>
      <th>producers</th>
      <td>['Bandai Visual']</td>
      <td>['Sunrise', 'Bandai Visual']</td>
      <td>['Victor Entertainment']</td>
    </tr>
    <tr>
      <th>genre</th>
      <td>['Action', 'Adventure', 'Comedy', 'Drama', 'Sc...</td>
      <td>['Action', 'Drama', 'Mystery', 'Sci-Fi', 'Space']</td>
      <td>['Action', 'Sci-Fi', 'Adventure', 'Comedy', 'D...</td>
    </tr>
    <tr>
      <th>studio</th>
      <td>['Sunrise']</td>
      <td>['Bones']</td>
      <td>['Madhouse']</td>
    </tr>
    <tr>
      <th>episodes</th>
      <td>26</td>
      <td>1</td>
      <td>26</td>
    </tr>
    <tr>
      <th>status</th>
      <td>Finished Airing</td>
      <td>Finished Airing</td>
      <td>Finished Airing</td>
    </tr>
    <tr>
      <th>airing</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>aired</th>
      <td>{'from': '1998-04-03T00:00:00+00:00', 'to': '1...</td>
      <td>{'from': '2001-09-01T00:00:00+00:00', 'to': No...</td>
      <td>{'from': '1998-04-01T00:00:00+00:00', 'to': '1...</td>
    </tr>
    <tr>
      <th>duration</th>
      <td>24 min per ep</td>
      <td>1 hr 55 min</td>
      <td>24 min per ep</td>
    </tr>
    <tr>
      <th>rating</th>
      <td>R - 17+ (violence &amp; profanity)</td>
      <td>R - 17+ (violence &amp; profanity)</td>
      <td>PG-13 - Teens 13 or older</td>
    </tr>
    <tr>
      <th>score</th>
      <td>8.81</td>
      <td>8.41</td>
      <td>8.3</td>
    </tr>
    <tr>
      <th>scored_by</th>
      <td>405664</td>
      <td>120243</td>
      <td>212537</td>
    </tr>
    <tr>
      <th>rank</th>
      <td>26</td>
      <td>164</td>
      <td>255</td>
    </tr>
    <tr>
      <th>popularity</th>
      <td>39</td>
      <td>449</td>
      <td>146</td>
    </tr>
    <tr>
      <th>members</th>
      <td>795733</td>
      <td>197791</td>
      <td>408548</td>
    </tr>
    <tr>
      <th>favorites</th>
      <td>43460</td>
      <td>776</td>
      <td>10432</td>
    </tr>
    <tr>
      <th>synopsis</th>
      <td>In the year 2071, humanity has colonized sever...</td>
      <td>Another day, another bounty—such is the life o...</td>
      <td>Vash the Stampede is the man with a $$60,000,0...</td>
    </tr>
    <tr>
      <th>background</th>
      <td>When Cowboy Bebop first aired in spring of 199...</td>
      <td>NaN</td>
      <td>The Japanese release by Victor Entertainment h...</td>
    </tr>
    <tr>
      <th>premiered</th>
      <td>Spring 1998</td>
      <td>NaN</td>
      <td>Spring 1998</td>
    </tr>
    <tr>
      <th>broadcast</th>
      <td>Saturdays at 01:00 (JST)</td>
      <td>NaN</td>
      <td>Thursdays at 01:15 (JST)</td>
    </tr>
    <tr>
      <th>related</th>
      <td>{'Adaptation': [{'mal_id': 173, 'type': 'manga...</td>
      <td>{'Parent story': [{'mal_id': 1, 'type': 'anime...</td>
      <td>{'Adaptation': [{'mal_id': 703, 'type': 'manga...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Step-1:-Clean-producers-column">
<h3>Step 1: Clean <code class="docutils literal notranslate"><span class="pre">producers</span></code> column<a class="headerlink" href="#Step-1:-Clean-producers-column" title="Permalink to this headline">¶</a></h3>
<p>The first step tries to clean up the <code class="docutils literal notranslate"><span class="pre">producers</span></code> column by removing some brackets (‘[]’) and trim off some empty spaces</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>clean_df &lt;- raw_df %&gt;%
 # Producers
 mutate(producers = str_remove(producers, &quot;\\[&quot;),
producers = str_remove(producers, &quot;\\]&quot;))
</pre></div>
</div>
</div></blockquote>
<p>What is mutate? This <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/getting_started/comparison/comparison_with_r.html">link</a> compares R’s <code class="docutils literal notranslate"><span class="pre">mutate</span></code> to be similar to pandas’ <code class="docutils literal notranslate"><span class="pre">df.assign</span></code>. However, <code class="docutils literal notranslate"><span class="pre">df.assign</span></code> returns a new DataFrame whereas <code class="docutils literal notranslate"><span class="pre">mutate</span></code> adds a new variable while preserving the previous ones. Therefore, for this example, I will compare <code class="docutils literal notranslate"><span class="pre">mutate</span></code> to be similar to <code class="docutils literal notranslate"><span class="pre">df['col']</span> <span class="pre">=</span> <span class="pre">X</span></code></p>
<p>As we can see, this is looks like a list of items but in string form</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Let&#39;s see what we trying to remove</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;producers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;\[&quot;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="s1">&#39;producers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0               [&#39;Bandai Visual&#39;]
1    [&#39;Sunrise&#39;, &#39;Bandai Visual&#39;]
2        [&#39;Victor Entertainment&#39;]
3               [&#39;Bandai Visual&#39;]
4          [&#39;TV Tokyo&#39;, &#39;Dentsu&#39;]
Name: producers, dtype: object
</pre></div></div>
</div>
<p>Let’s use pandas flavor to create a custom method for just removing some strings so we don’t have to use str.replace so many times.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nd">@pf</span><span class="o">.</span><span class="n">register_dataframe_method</span>
<span class="k">def</span> <span class="nf">str_remove</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pat</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper around df.str.replace</span>
<span class="sd">    The function will loop through regex patterns and remove them from the desired column.</span>

<span class="sd">    :param df: A pandas DataFrame.</span>
<span class="sd">    :param column_name: A `str` indicating which column the string removal action is to be made.</span>
<span class="sd">    :param pat: A regex pattern to match and remove.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Pattern should be a valid regex pattern. Received pattern: </span><span class="si">{</span><span class="n">pat</span><span class="si">}</span><span class="s2"> with dtype: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">pat</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clean_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span>
    <span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;producers&#39;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s1">&#39;\[|\]&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>With brackets removed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clean_df</span><span class="p">[</span><span class="s1">&#39;producers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0               &#39;Bandai Visual&#39;
1    &#39;Sunrise&#39;, &#39;Bandai Visual&#39;
2        &#39;Victor Entertainment&#39;
3               &#39;Bandai Visual&#39;
4          &#39;TV Tokyo&#39;, &#39;Dentsu&#39;
Name: producers, dtype: object
</pre></div></div>
</div>
<p>Brackets are removed. Now the next part &gt;<code class="docutils literal notranslate"><span class="pre">&gt;</span>&#160; <span class="pre">separate_rows(producers,</span> <span class="pre">sep</span> <span class="pre">=</span> <span class="pre">&quot;,&quot;)</span> <span class="pre">%&gt;%</span>&#160; <span class="pre">&gt;</span></code></p>
<p>It seems like separate rows will go through each value of the column, and if the value is a list, will create a new row for each value in the list with the remaining column values being the same. This is commonly known as an <code class="docutils literal notranslate"><span class="pre">explode</span></code> method but it is not yet implemented in pandas. We will need a function for this (code adopted from <a class="reference external" href="https://qiita.com/rikima/items/c10e27d8b7495af4c159">here</a>).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nd">@pf</span><span class="o">.</span><span class="n">register_dataframe_method</span>
<span class="k">def</span> <span class="nf">explode</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For rows with a list of values, this function will create new rows for each value in the list</span>

<span class="sd">    :param df: A pandas DataFrame.</span>
<span class="sd">    :param column_name: A `str` indicating which column the string removal action is to be made.</span>
<span class="sd">    :param sep: The delimiter. Example delimiters include `|`, `, `, `,` etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
    <span class="n">wdf</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="o">.</span><span class="n">stack</span><span class="p">()</span>
        <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="c1"># exploded_column = column_name</span>
    <span class="n">wdf</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]</span>  <span class="c1"># plural form to singular form</span>
    <span class="c1"># wdf[column_name] = wdf[column_name].apply(lambda x: x.strip())  # trim</span>
    <span class="n">wdf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">wdf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_drop&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">column_name</span> <span class="o">+</span> <span class="s2">&quot;_drop&quot;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clean_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">clean_df</span>
    <span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;producers&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now every producer is its own row.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clean_df</span><span class="p">[</span><span class="s1">&#39;producers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0           &#39;Bandai Visual&#39;
1                 &#39;Sunrise&#39;
2           &#39;Bandai Visual&#39;
3    &#39;Victor Entertainment&#39;
4           &#39;Bandai Visual&#39;
Name: producers, dtype: object
</pre></div></div>
</div>
<p>Now remove single quotes and a bit of trimming &gt;<code class="docutils literal notranslate"><span class="pre">mutate(producers</span> <span class="pre">=</span> <span class="pre">str_remove(producers,</span> <span class="pre">&quot;\\'&quot;),</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">producers</span> <span class="pre">=</span> <span class="pre">str_remove(producers,</span> <span class="pre">&quot;\\'&quot;),</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">producers</span> <span class="pre">=</span> <span class="pre">str_trim(producers))</span> <span class="pre">%&gt;%</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clean_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">clean_df</span>
    <span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;producers&#39;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>We’ll make another custom function for trimming whitespace.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nd">@pf</span><span class="o">.</span><span class="n">register_dataframe_method</span>
<span class="k">def</span> <span class="nf">str_trim</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove trailing and leading characters, in a given column&quot;&quot;&quot;</span>
    <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clean_df</span> <span class="o">=</span> <span class="n">clean_df</span><span class="o">.</span><span class="n">str_trim</span><span class="p">(</span><span class="s1">&#39;producers&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Finally, here is our cleaned <code class="docutils literal notranslate"><span class="pre">producers</span></code> column.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clean_df</span><span class="p">[</span><span class="s1">&#39;producers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0           Bandai Visual
1                 Sunrise
2           Bandai Visual
3    Victor Entertainment
4           Bandai Visual
Name: producers, dtype: object
</pre></div></div>
</div>
</section>
<section id="Step-2:-Clean-genre-and-studio-Columns">
<h3>Step 2: Clean <code class="docutils literal notranslate"><span class="pre">genre</span></code> and <code class="docutils literal notranslate"><span class="pre">studio</span></code> Columns<a class="headerlink" href="#Step-2:-Clean-genre-and-studio-Columns" title="Permalink to this headline">¶</a></h3>
<p>Let’s do the same process for columns <code class="docutils literal notranslate"><span class="pre">Genre</span></code> and <code class="docutils literal notranslate"><span class="pre">Studio</span></code></p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span> # Genre
mutate(genre = str_remove(genre, &quot;\\[&quot;),
genre = str_remove(genre, &quot;\\]&quot;)) %&gt;%
separate_rows(genre, sep = &quot;,&quot;) %&gt;%
mutate(genre = str_remove(genre, &quot;\\&#39;&quot;),
genre = str_remove(genre, &quot;\\&#39;&quot;),
genre = str_trim(genre)) %&gt;%
 # Studio
mutate(studio = str_remove(studio, &quot;\\[&quot;),
studio = str_remove(studio, &quot;\\]&quot;)) %&gt;%
separate_rows(studio, sep = &quot;,&quot;) %&gt;%
mutate(studio = str_remove(studio, &quot;\\&#39;&quot;),
studio = str_remove(studio, &quot;\\&#39;&quot;),
studio = str_trim(studio)) %&gt;%
</pre></div>
</div>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clean_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">clean_df</span>
    <span class="c1"># Perform operation for genre.</span>
    <span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s1">&#39;\[|\]&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_trim</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;genre&#39;</span><span class="p">)</span>
    <span class="c1"># Now do it for studio</span>
    <span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;studio&#39;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s1">&#39;\[|\]&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;studio&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;studio&#39;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_trim</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;studio&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Resulting cleaned columns.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clean_df</span><span class="p">[[</span><span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="s1">&#39;studio&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>genre</th>
      <th>studio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Action</td>
      <td>Sunrise</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adventure</td>
      <td>Sunrise</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Comedy</td>
      <td>Sunrise</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Drama</td>
      <td>Sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sci-Fi</td>
      <td>Sunrise</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Step-3:-Clean-aired-column">
<h3>Step 3: Clean <code class="docutils literal notranslate"><span class="pre">aired</span></code> column<a class="headerlink" href="#Step-3:-Clean-aired-column" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">aired</span></code> column has something a little different. In addition to the usual removing some strings and whitespace trimming, we want to separate the values into two separate columns <code class="docutils literal notranslate"><span class="pre">start_date</span></code> and <code class="docutils literal notranslate"><span class="pre">end_date</span></code></p>
<blockquote>
<div><div class="highlight-r notranslate"><div class="highlight"><pre><span></span> <span class="c1"># Aired</span>
<span class="nf">mutate</span><span class="p">(</span><span class="n">aired</span> <span class="o">=</span> <span class="nf">str_remove</span><span class="p">(</span><span class="n">aired</span><span class="p">,</span> <span class="s">&quot;\\{&quot;</span><span class="p">),</span>
<span class="n">aired</span> <span class="o">=</span> <span class="nf">str_remove</span><span class="p">(</span><span class="n">aired</span><span class="p">,</span> <span class="s">&quot;\\}&quot;</span><span class="p">),</span>
<span class="n">aired</span> <span class="o">=</span> <span class="nf">str_remove</span><span class="p">(</span><span class="n">aired</span><span class="p">,</span> <span class="s">&quot;&#39;from&#39;: &quot;</span><span class="p">),</span>
<span class="n">aired</span> <span class="o">=</span> <span class="nf">str_remove</span><span class="p">(</span><span class="n">aired</span><span class="p">,</span> <span class="s">&quot;&#39;to&#39;: &quot;</span><span class="p">),</span>
<span class="n">aired</span> <span class="o">=</span> <span class="nf">word</span><span class="p">(</span><span class="n">aired</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="p">))</span> <span class="o">%&gt;%</span>
<span class="nf">separate</span><span class="p">(</span><span class="n">aired</span><span class="p">,</span> <span class="n">into</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;start_date&quot;</span><span class="p">,</span> <span class="s">&quot;end_date&quot;</span><span class="p">),</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
<span class="nf">mutate</span><span class="p">(</span><span class="n">start_date</span> <span class="o">=</span> <span class="nf">str_remove_all</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="s">&quot;&#39;&quot;</span><span class="p">),</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="nf">str_sub</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">10</span><span class="p">),</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="nf">str_remove_all</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="s">&quot;&#39;&quot;</span><span class="p">),</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="nf">str_sub</span><span class="p">(</span><span class="n">end_date</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">10</span><span class="p">))</span> <span class="o">%&gt;%</span>
<span class="nf">mutate</span><span class="p">(</span><span class="n">start_date</span> <span class="o">=</span> <span class="n">lubridate</span><span class="o">::</span><span class="nf">ymd</span><span class="p">(</span><span class="n">start_date</span><span class="p">),</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">lubridate</span><span class="o">::</span><span class="nf">ymd</span><span class="p">(</span><span class="n">end_date</span><span class="p">))</span> <span class="o">%&gt;%</span>
</pre></div>
</div>
</div></blockquote>
<p>We will create some custom wrapper functions to emulate R’s <code class="docutils literal notranslate"><span class="pre">word</span></code> and use pyjanitor’s <code class="docutils literal notranslate"><span class="pre">deconcatenate_column</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Currently looks like this</span>
<span class="n">clean_df</span><span class="p">[</span><span class="s1">&#39;aired&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0    {&#39;from&#39;: &#39;1998-04-03T00:00:00+00:00&#39;, &#39;to&#39;: &#39;1...
1    {&#39;from&#39;: &#39;1998-04-03T00:00:00+00:00&#39;, &#39;to&#39;: &#39;1...
2    {&#39;from&#39;: &#39;1998-04-03T00:00:00+00:00&#39;, &#39;to&#39;: &#39;1...
3    {&#39;from&#39;: &#39;1998-04-03T00:00:00+00:00&#39;, &#39;to&#39;: &#39;1...
4    {&#39;from&#39;: &#39;1998-04-03T00:00:00+00:00&#39;, &#39;to&#39;: &#39;1...
Name: aired, dtype: object
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nd">@pf</span><span class="o">.</span><span class="n">register_dataframe_method</span>
<span class="k">def</span> <span class="nf">str_word</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span>
    <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pat</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper around `df.str.split` with additional `start` and `end` arguments</span>
<span class="sd">    to select a slice of the list of words.</span>

<span class="sd">    :param df: A pandas DataFrame.</span>
<span class="sd">    :param column_name: A `str` indicating which column the split action is to be made.</span>
<span class="sd">    :param start: optional An `int` for the start index of the slice</span>
<span class="sd">    :param stop: optinal  An `int` for the end index of the slice</span>
<span class="sd">    :param pat: String or regular expression to split on. If not specified, split on whitespace.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">pat</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span>


<span class="nd">@pf</span><span class="o">.</span><span class="n">register_dataframe_method</span>
<span class="k">def</span> <span class="nf">str_join</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper around `df.str.join`</span>
<span class="sd">    Joins items in a list.</span>

<span class="sd">    :param df: A pandas DataFrame.</span>
<span class="sd">    :param column_name: A `str` indicating which column the split action is to be made.</span>
<span class="sd">    :param sep: The delimiter. Example delimiters include `|`, `, `, `,` etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>


<span class="nd">@pf</span><span class="o">.</span><span class="n">register_dataframe_method</span>
<span class="k">def</span> <span class="nf">str_slice</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper around `df.str.slice</span>
<span class="sd">    Slices strings.</span>

<span class="sd">    :param df: A pandas DataFrame.</span>
<span class="sd">    :param column_name: A `str` indicating which column the split action is to be made.</span>
<span class="sd">    :param start: &#39;int&#39; indicating start of slice.</span>
<span class="sd">    :param stop: &#39;int&#39; indicating stop of slice.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clean_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">clean_df</span><span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;aired&quot;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s2">&quot;\{|\}|&#39;from&#39;:\s*|&#39;to&#39;:\s*&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_word</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;aired&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_join</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;aired&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="c1"># .add_columns({&#39;start_date&#39;: clean_df[&#39;aired&#39;][0]})</span>
    <span class="o">.</span><span class="n">deconcatenate_column</span><span class="p">(</span>
        <span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;aired&quot;</span><span class="p">,</span> <span class="n">new_column_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;start_date&quot;</span><span class="p">,</span> <span class="s2">&quot;end_date&quot;</span><span class="p">],</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="n">column_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;aired&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;start_date&quot;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_slice</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;start_date&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_remove</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;end_date&quot;</span><span class="p">,</span> <span class="n">pat</span><span class="o">=</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str_slice</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;end_date&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;start_date&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;end_date&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Resulting &#39;start_date&#39; and &#39;end_date&#39; columns with &#39;aired&#39; column removed</span>
<span class="n">clean_df</span><span class="p">[[</span><span class="s1">&#39;start_date&#39;</span><span class="p">,</span> <span class="s1">&#39;end_date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>start_date</th>
      <th>end_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1998-04-03</td>
      <td>1999-04-24</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1998-04-03</td>
      <td>1999-04-24</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1998-04-03</td>
      <td>1999-04-24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1998-04-03</td>
      <td>1999-04-24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1998-04-03</td>
      <td>1999-04-24</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Step-4:-Filter-out-unranked-and-unpopular-series">
<h3>Step 4: Filter out unranked and unpopular series<a class="headerlink" href="#Step-4:-Filter-out-unranked-and-unpopular-series" title="Permalink to this headline">¶</a></h3>
<p>Finally, let’s drop the unranked or unpopular series with pyjanitor’s <code class="docutils literal notranslate"><span class="pre">filter_on</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># First fill any NA values with 0 and then filter != 0</span>
<span class="n">clean_df</span> <span class="o">=</span> <span class="n">clean_df</span><span class="o">.</span><span class="n">fill_empty</span><span class="p">(</span><span class="n">column_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rank&quot;</span><span class="p">,</span> <span class="s2">&quot;popularity&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">filter_on</span><span class="p">(</span>
    <span class="s2">&quot;rank != 0 &amp; popularity != 0&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="End-Result">
<h3>End Result<a class="headerlink" href="#End-Result" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clean_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>animeID</th>
      <th>name</th>
      <th>title_english</th>
      <th>title_japanese</th>
      <th>title_synonyms</th>
      <th>type</th>
      <th>source</th>
      <th>episodes</th>
      <th>status</th>
      <th>airing</th>
      <th>...</th>
      <th>synopsis</th>
      <th>background</th>
      <th>premiered</th>
      <th>broadcast</th>
      <th>related</th>
      <th>producers</th>
      <th>genre</th>
      <th>studio</th>
      <th>start_date</th>
      <th>end_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Cowboy Bebop</td>
      <td>Cowboy Bebop</td>
      <td>カウボーイビバップ</td>
      <td>[]</td>
      <td>TV</td>
      <td>Original</td>
      <td>26.0</td>
      <td>Finished Airing</td>
      <td>False</td>
      <td>...</td>
      <td>In the year 2071, humanity has colonized sever...</td>
      <td>When Cowboy Bebop first aired in spring of 199...</td>
      <td>Spring 1998</td>
      <td>Saturdays at 01:00 (JST)</td>
      <td>{'Adaptation': [{'mal_id': 173, 'type': 'manga...</td>
      <td>Bandai Visual</td>
      <td>Action</td>
      <td>Sunrise</td>
      <td>1998-04-03</td>
      <td>1999-04-24</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Cowboy Bebop</td>
      <td>Cowboy Bebop</td>
      <td>カウボーイビバップ</td>
      <td>[]</td>
      <td>TV</td>
      <td>Original</td>
      <td>26.0</td>
      <td>Finished Airing</td>
      <td>False</td>
      <td>...</td>
      <td>In the year 2071, humanity has colonized sever...</td>
      <td>When Cowboy Bebop first aired in spring of 199...</td>
      <td>Spring 1998</td>
      <td>Saturdays at 01:00 (JST)</td>
      <td>{'Adaptation': [{'mal_id': 173, 'type': 'manga...</td>
      <td>Bandai Visual</td>
      <td>Adventure</td>
      <td>Sunrise</td>
      <td>1998-04-03</td>
      <td>1999-04-24</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Cowboy Bebop</td>
      <td>Cowboy Bebop</td>
      <td>カウボーイビバップ</td>
      <td>[]</td>
      <td>TV</td>
      <td>Original</td>
      <td>26.0</td>
      <td>Finished Airing</td>
      <td>False</td>
      <td>...</td>
      <td>In the year 2071, humanity has colonized sever...</td>
      <td>When Cowboy Bebop first aired in spring of 199...</td>
      <td>Spring 1998</td>
      <td>Saturdays at 01:00 (JST)</td>
      <td>{'Adaptation': [{'mal_id': 173, 'type': 'manga...</td>
      <td>Bandai Visual</td>
      <td>Comedy</td>
      <td>Sunrise</td>
      <td>1998-04-03</td>
      <td>1999-04-24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Cowboy Bebop</td>
      <td>Cowboy Bebop</td>
      <td>カウボーイビバップ</td>
      <td>[]</td>
      <td>TV</td>
      <td>Original</td>
      <td>26.0</td>
      <td>Finished Airing</td>
      <td>False</td>
      <td>...</td>
      <td>In the year 2071, humanity has colonized sever...</td>
      <td>When Cowboy Bebop first aired in spring of 199...</td>
      <td>Spring 1998</td>
      <td>Saturdays at 01:00 (JST)</td>
      <td>{'Adaptation': [{'mal_id': 173, 'type': 'manga...</td>
      <td>Bandai Visual</td>
      <td>Drama</td>
      <td>Sunrise</td>
      <td>1998-04-03</td>
      <td>1999-04-24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Cowboy Bebop</td>
      <td>Cowboy Bebop</td>
      <td>カウボーイビバップ</td>
      <td>[]</td>
      <td>TV</td>
      <td>Original</td>
      <td>26.0</td>
      <td>Finished Airing</td>
      <td>False</td>
      <td>...</td>
      <td>In the year 2071, humanity has colonized sever...</td>
      <td>When Cowboy Bebop first aired in spring of 199...</td>
      <td>Spring 1998</td>
      <td>Saturdays at 01:00 (JST)</td>
      <td>{'Adaptation': [{'mal_id': 173, 'type': 'manga...</td>
      <td>Bandai Visual</td>
      <td>Sci-Fi</td>
      <td>Sunrise</td>
      <td>1998-04-03</td>
      <td>1999-04-24</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo_title.svg" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pyjanitor_intro.html">pyjanitor Usage Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="Pivoting%20Data%20from%20Wide%20to%20Long.html">Pivot_Longer : One function to cover transformations from wide to long form.</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="Row_to_Names.html">row_to_names : Elevates a row to be the column names of a DataFrame.</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Processing Anime Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Background">Background</a></li>
<li class="toctree-l3"><a class="reference internal" href="#One-Shot">One-Shot</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Multi-Step">Multi-Step</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Step-0:-Load-data">Step 0: Load data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Step-1:-Clean-producers-column">Step 1: Clean <code class="docutils literal notranslate"><span class="pre">producers</span></code> column</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Step-2:-Clean-genre-and-studio-Columns">Step 2: Clean <code class="docutils literal notranslate"><span class="pre">genre</span></code> and <code class="docutils literal notranslate"><span class="pre">studio</span></code> Columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Step-3:-Clean-aired-column">Step 3: Clean <code class="docutils literal notranslate"><span class="pre">aired</span></code> column</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Step-4:-Filter-out-unranked-and-unpopular-series">Step 4: Filter out unranked and unpopular series</a></li>
<li class="toctree-l4"><a class="reference internal" href="#End-Result">End Result</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bad_values.html">Replacing Bad Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="bird_call.html">Processing Bird Call Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="board_games.html">Processing Board Game Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="dirty_data.html">Processing Dirty Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="expand_grid.html">Expand_grid : Create a dataframe from all combinations of inputs.</a></li>
<li class="toctree-l2"><a class="reference internal" href="french_trains.html">Processing French train data</a></li>
<li class="toctree-l2"><a class="reference internal" href="groupby_agg.html">Groupby_agg : Shortcut for assigning a groupby-transform to a new column.</a></li>
<li class="toctree-l2"><a class="reference internal" href="inflating_converting_currency.html">Inflating and Converting Currency</a></li>
<li class="toctree-l2"><a class="reference internal" href="medium_franchise.html">Tidy Up Web-Scraped Media Franchise Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="normalize.html">Normalization and Standardization</a></li>
<li class="toctree-l2"><a class="reference internal" href="sort_naturally.html">Using <code class="docutils literal notranslate"><span class="pre">sort_naturally</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="teacher_pupil.html">Processing International Teacher Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="transform_column.html">Transforming columns</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Contributors</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../notebooks.html">Examples</a><ul>
      <li>Previous: <a href="Row_to_Names.html" title="previous chapter">row_to_names : Elevates a row to be the column names of a DataFrame.</a></li>
      <li>Next: <a href="bad_values.html" title="next chapter">Replacing Bad Values</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, PyJanitor devs.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/notebooks/anime.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>