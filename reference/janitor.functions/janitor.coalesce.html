
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>janitor.coalesce &#8212; pyjanitor  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="janitor.find_replace" href="janitor.find_replace.html" />
    <link rel="prev" title="janitor.remove_empty" href="janitor.remove_empty.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="janitor-coalesce">
<h1>janitor.coalesce<a class="headerlink" href="#janitor-coalesce" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="janitor.coalesce">
<span class="sig-prename descclassname"><span class="pre">janitor.</span></span><span class="sig-name descname"><span class="pre">coalesce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_names</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_column_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="../../_modules/janitor/functions.html#coalesce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#janitor.coalesce" title="Permalink to this definition">¶</a></dt>
<dd><p>Coalesce two or more columns of data in order of column names provided.</p>
<p>This finds the first non-missing value at each position.</p>
<p>This method does not mutate the original DataFrame.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">janitor</span> <span class="k">as</span> <span class="nn">jn</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
                   <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
                   <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">]})</span>

     <span class="n">A</span>     <span class="n">B</span>   <span class="n">C</span>
<span class="mi">0</span>  <span class="mf">1.0</span>   <span class="n">NaN</span>   <span class="mi">5</span>
<span class="mi">1</span>  <span class="mf">2.0</span>  <span class="mf">10.0</span>  <span class="mi">10</span>
<span class="mi">2</span>  <span class="n">NaN</span>   <span class="n">NaN</span>   <span class="mi">7</span>

<span class="n">df</span><span class="o">.</span><span class="n">coalesce</span><span class="p">(</span><span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
            <span class="n">target_column_name</span> <span class="o">=</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>

    <span class="n">A</span>     <span class="n">B</span>   <span class="n">C</span>    <span class="n">D</span>
<span class="mi">0</span>  <span class="mf">1.0</span>   <span class="n">NaN</span>   <span class="mi">5</span>  <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mf">2.0</span>  <span class="mf">10.0</span>  <span class="mi">10</span>  <span class="mf">2.0</span>
<span class="mi">2</span>  <span class="n">NaN</span>   <span class="n">NaN</span>   <span class="mi">7</span>  <span class="mf">7.0</span>
</pre></div>
</div>
<p>If no target column is provided, then the first column is updated,
with the null values removed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">coalesce</span><span class="p">(</span><span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>

    <span class="n">A</span>     <span class="n">B</span>   <span class="n">C</span>
<span class="mi">0</span>  <span class="mf">1.0</span>   <span class="n">NaN</span>   <span class="mi">5</span>
<span class="mi">1</span>  <span class="mf">2.0</span>  <span class="mf">10.0</span>  <span class="mi">10</span>
<span class="mi">2</span>  <span class="mf">7.0</span>   <span class="n">NaN</span>   <span class="mi">7</span>
</pre></div>
</div>
<p>If nulls remain, you can fill it with the <cite>default_value</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;s1&#39;</span><span class="p">:[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span>
                   <span class="s1">&#39;s2&#39;</span><span class="p">:[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">]})</span>

    <span class="n">s1</span>   <span class="n">s2</span>
<span class="mi">0</span>  <span class="n">NaN</span>  <span class="n">NaN</span>
<span class="mi">1</span>  <span class="n">NaN</span>  <span class="mf">8.0</span>
<span class="mi">2</span>  <span class="mf">6.0</span>  <span class="mf">7.0</span>
<span class="mi">3</span>  <span class="mf">9.0</span>  <span class="mf">9.0</span>
<span class="mi">4</span>  <span class="mf">9.0</span>  <span class="mf">9.0</span>

<span class="n">df</span><span class="o">.</span><span class="n">coalesce</span><span class="p">(</span><span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="s1">&#39;s2&#39;</span><span class="p">],</span>
            <span class="n">target_column_name</span> <span class="o">=</span> <span class="s1">&#39;s3&#39;</span><span class="p">,</span>
            <span class="n">default_value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">s1</span>   <span class="n">s2</span>   <span class="n">s3</span>
<span class="mi">0</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="mf">0.0</span>
<span class="mi">1</span>  <span class="n">NaN</span>  <span class="mf">8.0</span>  <span class="mf">8.0</span>
<span class="mi">2</span>  <span class="mf">6.0</span>  <span class="mf">7.0</span>  <span class="mf">6.0</span>
<span class="mi">3</span>  <span class="mf">9.0</span>  <span class="mf">9.0</span>  <span class="mf">9.0</span>
<span class="mi">4</span>  <span class="mf">9.0</span>  <span class="mf">9.0</span>  <span class="mf">9.0</span>
</pre></div>
</div>
<p>Functional usage syntax:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">coalesce</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;col1&#39;</span><span class="p">,</span> <span class="s1">&#39;col2&#39;</span><span class="p">],</span> <span class="s1">&#39;col3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Method chaining syntax:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">janitor</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">coalesce</span><span class="p">([</span><span class="s1">&#39;col1&#39;</span><span class="p">,</span> <span class="s1">&#39;col2&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The first example will create a new column called ‘col3’ with values from
‘col2’ inserted where values from ‘col1’ are NaN.
The second example will update the values of ‘col1’,
since it is the first column in <cite>column_names</cite>.</p>
<p>This is more syntactic diabetes! For R users, this should look familiar to
<cite>dplyr</cite>’s <cite>coalesce</cite> function; for Python users, the interface
should be more intuitive than the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.combine_first.html#pandas.Series.combine_first" title="(in pandas v1.3.1)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.combine_first()</span></code></a>
method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – A pandas DataFrame.</p></li>
<li><p><strong>column_names</strong> – A list of column names.</p></li>
<li><p><strong>target_column_name</strong> – The new column name after combining.
If <cite>None</cite>, then the first column in <cite>column_names</cite> is updated,
with the Null values replaced.</p></li>
<li><p><strong>default_value</strong> – A scalar to replace any remaining nulls
after coalescing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A pandas DataFrame with coalesced columns.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – if length of <cite>column_names</cite> is less than 2.</p>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo_title.svg" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../biology.html">Biology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chemistry.html">Chemistry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../engineering.html">Engineering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../finance.html">Finance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml.html">Machine Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../timeseries.html">Time Series</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../general_functions.html">General Functions</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../general_functions.html#modify-columns">Modify columns</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../general_functions.html#modify-values">Modify values</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="janitor.fill_empty.html">janitor.fill_empty</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.fill_direction.html">janitor.fill_direction</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.convert_excel_date.html">janitor.convert_excel_date</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.convert_matlab_date.html">janitor.convert_matlab_date</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.convert_unix_date.html">janitor.convert_unix_date</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.remove_empty.html">janitor.remove_empty</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">janitor.coalesce</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.find_replace.html">janitor.find_replace</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.round_to_fraction.html">janitor.round_to_fraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.update_where.html">janitor.update_where</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.to_datetime.html">janitor.to_datetime</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.jitter.html">janitor.jitter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../general_functions.html#filtering">Filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../general_functions.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../general_functions.html#other">Other</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../pyspark.html">General PySpark Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../xarray.html">General XArray Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Contributors</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">API Documentation</a><ul>
  <li><a href="../general_functions.html">General Functions</a><ul>
      <li>Previous: <a href="janitor.remove_empty.html" title="previous chapter">janitor.remove_empty</a></li>
      <li>Next: <a href="janitor.find_replace.html" title="next chapter">janitor.find_replace</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, PyJanitor devs.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/reference/janitor.functions/janitor.coalesce.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>